{"version":3,"kind":"Notebook","sha256":"7083f655249f59ab8a73c4dc616182053883875dfff88c271a8fe6f85573ac5e","slug":"chapter12-sec03","location":"/chapter12/chapter12_sec03.md","dependencies":[],"frontmatter":{"title":"12.3 Neuronale Netze mit Scikit-Learn","kernelspec":{"name":"python3","display_name":"Python 3","language":"python"},"jupytext":{"formats":"ipynb,md:myst","text_representation":{"extension":".md","format_name":"myst","format_version":"0.13","jupytext_version":"1.15.2"}},"content_includes_title":false,"authors":[{"id":"Simone Gramsch","name":"Simone Gramsch"}],"open_access":true,"license":{"content":{"id":"CC-BY-NC-SA-4.0","url":"https://creativecommons.org/licenses/by-nc-sa/4.0/","name":"Creative Commons Attribution Non Commercial Share Alike 4.0 International","CC":true}},"github":"https://github.com/gramschs/book_ml4ing","numbering":{"title":{"offset":1}},"source_url":"https://github.com/gramschs/book_ml4ing/blob/main/chapter12/chapter12_sec03.md","edit_url":"https://github.com/gramschs/book_ml4ing/edit/main/chapter12/chapter12_sec03.md","exports":[{"format":"md","filename":"chapter12_sec03.md","url":"/book_ml4ing/build/chapter12_sec03-e1b17727b03b4dfda54292d28204a035.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Lernziele","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"ty5wYxo01d"}],"key":"wqNk8Smfbh"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Sie können mit Scikit-Learn ein neuronales Netz zur Klassifikation trainieren.","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"N90yDDRwdE"}],"key":"ECWg4bypKs"}],"key":"np5oLd6ApH"}],"key":"X46LjR25vb"}],"class":"attention","key":"dXXhRsJhDu"}],"key":"eqMkYU90ll"},{"type":"block","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"Neuronale Netze zur Klassifikation","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"mB8IvD6QZx"}],"identifier":"neuronale-netze-zur-klassifikation","label":"Neuronale Netze zur Klassifikation","html_id":"neuronale-netze-zur-klassifikation","implicit":true,"key":"euCQPGIwvJ"},{"type":"paragraph","position":{"start":{"line":26,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"text","value":"Schauen wir uns an, wie das Training eines tiefen neuronalen Netzes in\nScikit-Learn funktioniert. Dazu benutzen wir aus dem Untermodul\n","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"croRTIRkMT"},{"type":"inlineCode","value":"sklearn.neural_network","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"kMj5QmMlZk"},{"type":"text","value":" den ","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"yaj08z2Jbs"},{"type":"inlineCode","value":"MLPClassifier","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"CsoBZDw7HY"},{"type":"text","value":", also ein\nMulti-Layer-Perzeptron für Klassifikationsaufgaben:","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"XABMyjWxNM"}],"key":"cFQjXFwOmN"},{"type":"blockquote","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"link","url":"https://scikit-learn.org/stable/modules/generated/sklearn.neural_network.MLPClassifier.html#sklearn.neural_network.MLPClassifier","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"text","value":"https://​scikit​-learn​.org​/stable​/modules​/generated​/sklearn​.neural​_network​.MLPClassifier​.html​#sklearn​.neural​_network​.MLPClassifier","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"TaFsgVQi4p"}],"urlSource":"https://scikit-learn.org/stable/modules/generated/sklearn.neural_network.MLPClassifier.html#sklearn.neural_network.MLPClassifier","key":"Gyg79o4y1P"}],"key":"FptX3Nb4a3"}],"key":"c5e305LezL"},{"type":"paragraph","position":{"start":{"line":33,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"text","value":"Wir benutzen künstliche Daten, um die Anwendung des MLPClassifiers zu\ndemonstrieren.","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"yJOwDDdrlk"}],"key":"fyYuq5FSJs"}],"key":"k73qYDYU2T"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import pandas as pd\nimport plotly.express as px\nfrom sklearn.datasets import make_circles\n\n\n# Generiere künstliche Daten\nX, y = make_circles(noise=0.2, factor=0.5, random_state=1)\n\n# Konvertierung in ein DataFrame-Objekt für Plotly Express\ndf = pd.DataFrame({\n    'Feature 1': X[:, 0],\n    'Feature 2': X[:, 1],\n    'Category': pd.Series(y, dtype='category')\n})\n\n# Visualisierung\nfig = px.scatter(df, x='Feature 1', y='Feature 2', color='Category',\n                 title='Künstliche Daten')\nfig.show()","key":"NXfAnIOF4r"},{"type":"outputs","id":"Mjhi8NjRsVHzzMzRsNeIv","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"application/vnd.plotly.v1+json":{"content":"{\"data\":[{\"hovertemplate\":\"Category=1<br>Feature 1=%{x}<br>Feature 2=%{y}<extra></extra>\",\"legendgroup\":\"1\",\"marker\":{\"color\":\"#636efa\",\"symbol\":\"circle\"},\"mode\":\"markers\",\"name\":\"1\",\"orientation\":\"v\",\"showlegend\":true,\"x\":{\"dtype\":\"f8\",\"bdata\":\"mgZq+0mB2L/YTFOCI3eVv6ZWgPO4x+O/Rhg/FeWC5j/j4e/54Cjdv9hyiL8J+NC/6N/6jLvOw79SCDt7KJjNP85uwm/3huA/KjV0XXr85T/WB3at7YXhP9gBeKdXYt6/nuaSdPfk6L9pdqyAphjeP/b5+k9dvqW/YO1u7Z/Txj/IQTohlrW8v+YatLyav+k/qIjdkD8mtT+xv6M8IwzKP+Y93sUuv8E/GDtmC+rjrb+COqDEmlakvx8kgN1Xb9k/8kM+SXCk179OQcviSC7iv67yr+cm2LA/lEa0fBpyxz9qtDouP5PQP+HAXVqpQNo/67Rz9MfXzT/5GtAbI9Hcv8tV4nhWr82/GMPEo54f47+ywLWCY8XPP7DRczgrvtU/oAgvh74viz9Cuif3VgLPP5bTcxWqaMU/x6yzoF+7rL8umsTBTC/TP5jrHQlmEay/uHFR3U6Lz79dZ3O6DprgP7kqlPYfrtW/fL8a8VA91r+bZVXgIwKzvyAK62zSw9y/kjFruiNk3r82jSXqNbfkvw==\"},\"xaxis\":\"x\",\"y\":{\"dtype\":\"f8\",\"bdata\":\"iGUuA0tBt7+w+L57fZXevwRafqihV7C/qBcLjd/wx7+w9iIZ4ijBv6JcP+XHHto/CsVtVh6A2j/dQmmWXAzhv/wFEx5+Ut8/wD9no8fml7/Cfm+m8RjFv9T1ONDzo9W/23z9+dr6wD/5jXCbhPzTv/177SLY/tA/ukZJ2fTR37++EH7AYRrnP00gUtC2e8O/5JmCoNYTvr8h2yQIF+/Xv4pqxptmmc6/HIirAFE70j+UR6+h9jLavz4TwXkkZco/EMUGMNaVij8aooPOsWzav8usfzyNJeC/1RXs5A1Utj9WkqRulmbZP8qEEtdi09g/Lh6+rOIr6r9UKqnpQRGjvwRVFKK+K+A/S6I33FDv0T/Du0dt8ofhv2xSKAFbKbs/9YSofAxI5L8w55/PaWHfP6aXeiJcJM4/QfE3LZTa2D/qIGRsi1W0v13qW3r9ksc/oIa5uYqz27/gkb5GJEzTPw3V83H7990/oudL1Xs0wT/yvcNClPbLP9w3IcRJTK2/KiXGcC7MzL/UryxOWELXvw==\"},\"yaxis\":\"y\",\"type\":\"scatter\"},{\"hovertemplate\":\"Category=0<br>Feature 1=%{x}<br>Feature 2=%{y}<extra></extra>\",\"legendgroup\":\"0\",\"marker\":{\"color\":\"#EF553B\",\"symbol\":\"circle\"},\"mode\":\"markers\",\"name\":\"0\",\"orientation\":\"v\",\"showlegend\":true,\"x\":{\"dtype\":\"f8\",\"bdata\":\"Kde2w/ZZ2b+soF/8zGvdv6hWjTPS29y/eNocqaH/wz8IEB0UTZjUv5cUMzdTMvG/bmgBeQ2Q6D9YosRaCr3DP5QFn07lF+U/usg0634r57/KQB79hqfXv65V2RWSDu6/Vcz8JuNK4D8KDDA0hISsv42bC3OL+9Q/bEy3KEx27D9Wofqh7RPxv2yYe2cLOeO/cI6GqR9Moj/KvX+CMEXaP8WFnnxqPew/3PfGr2Q86L/sIuBb+4TlP5TAMj7MGfK/1IwVNNTy8D9UTbf3CHLuP6xJReeVW+O/q7PlXDwk7T9kGHlh+Avqv30yOBjRquc/y34uGJRV4j8eq6o9T67gP018+Niv2vA/IIiCiLiQ7L/KNSAUQRrrP0YsxM8f+8G/WHTek5UHzr91lQSgDRzyv52EiEuKku2/rJYmRVJ9zD8QytQGpznmv82LvdJ7lPC/L7HUKgfH6L9HKfdvr97mP+sA54OxE/I/DSXfDYuE2L94Kj7uXXPrP46TkfGxKcA/6loBD6Vc3j82Txa5na7Yvw==\"},\"xaxis\":\"x\",\"y\":{\"dtype\":\"f8\",\"bdata\":\"8udDJX6h9L87kfANmDvmP/1onaoO5+a/5U208xbF678FpW8V8sbpv2j0PZazd+e/7KJkM9fW278vedZLQSvxP+xFLrwal8o/BpW+u5E83z8qPVWJ0Arxv2pGEjZb2dq/hwoQXXm25r+TxtHCwkrqv35y3/B/H/C/EAlWPQgJ2b8ezK04FjbMPxvqOlQkQea/yVN/f8vd3T+E6MjtqJDnv9WR6D3XFOa/7DWgbP2Isr80Mj66sc/av7fZu8G1yd4/6uOQVguj5D/kWRdy0vCkv94OR6DqINw/3FOnYDqm0z/6NO+FAbfkv4AIrt9r9+q/l3xy3qH3079Ui3LqUx3uP+q+5JrbgJa/GK/D4OJN5D8MAxy9OA/qPzwlXEcOMuc/JN74Z52C5D9P2jsHK9Tjv+Sf3FZL/ty/aAENEiao6D+YGCdA6/bgP2ZA852wv+g/dUQJ+osmmj/Y+U+utTLiP7YiCGRr7KU/6pilzz9R6T8kV384xGjkPzNV0INF1es/Ia6b8x4t8D87Y8YUE+7pvw==\"},\"yaxis\":\"y\",\"type\":\"scatter\"}],\"layout\":{\"template\":{\"data\":{\"histogram2dcontour\":[{\"type\":\"histogram2dcontour\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1,\"#f0f921\"]]}],\"choropleth\":[{\"type\":\"choropleth\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"histogram2d\":[{\"type\":\"histogram2d\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1,\"#f0f921\"]]}],\"heatmap\":[{\"type\":\"heatmap\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1,\"#f0f921\"]]}],\"contourcarpet\":[{\"type\":\"contourcarpet\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"contour\":[{\"type\":\"contour\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1,\"#f0f921\"]]}],\"surface\":[{\"type\":\"surface\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1,\"#f0f921\"]]}],\"mesh3d\":[{\"type\":\"mesh3d\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"scatter\":[{\"fillpattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2},\"type\":\"scatter\"}],\"parcoords\":[{\"type\":\"parcoords\",\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterpolargl\":[{\"type\":\"scatterpolargl\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"bar\":[{\"error_x\":{\"color\":\"#2a3f5f\"},\"error_y\":{\"color\":\"#2a3f5f\"},\"marker\":{\"line\":{\"color\":\"#E5ECF6\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"scattergeo\":[{\"type\":\"scattergeo\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterpolar\":[{\"type\":\"scatterpolar\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"scattergl\":[{\"type\":\"scattergl\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatter3d\":[{\"type\":\"scatter3d\",\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scattermap\":[{\"type\":\"scattermap\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scattermapbox\":[{\"type\":\"scattermapbox\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterternary\":[{\"type\":\"scatterternary\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scattercarpet\":[{\"type\":\"scattercarpet\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"minorgridcolor\":\"white\",\"startlinecolor\":\"#2a3f5f\"},\"baxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"minorgridcolor\":\"white\",\"startlinecolor\":\"#2a3f5f\"},\"type\":\"carpet\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#EBF0F8\"},\"line\":{\"color\":\"white\"}},\"header\":{\"fill\":{\"color\":\"#C8D4E3\"},\"line\":{\"color\":\"white\"}},\"type\":\"table\"}],\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"#E5ECF6\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}]},\"layout\":{\"autotypenumbers\":\"strict\",\"colorway\":[\"#636efa\",\"#EF553B\",\"#00cc96\",\"#ab63fa\",\"#FFA15A\",\"#19d3f3\",\"#FF6692\",\"#B6E880\",\"#FF97FF\",\"#FECB52\"],\"font\":{\"color\":\"#2a3f5f\"},\"hovermode\":\"closest\",\"hoverlabel\":{\"align\":\"left\"},\"paper_bgcolor\":\"white\",\"plot_bgcolor\":\"#E5ECF6\",\"polar\":{\"bgcolor\":\"#E5ECF6\",\"angularaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"radialaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"}},\"ternary\":{\"bgcolor\":\"#E5ECF6\",\"aaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"caxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"}},\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"sequential\":[[0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1,\"#f0f921\"]],\"sequentialminus\":[[0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1,\"#f0f921\"]],\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]]},\"xaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"white\",\"automargin\":true,\"zerolinewidth\":2},\"yaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"white\",\"automargin\":true,\"zerolinewidth\":2},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2},\"yaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2},\"zaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2}},\"shapedefaults\":{\"line\":{\"color\":\"#2a3f5f\"}},\"annotationdefaults\":{\"arrowcolor\":\"#2a3f5f\",\"arrowhead\":0,\"arrowwidth\":1},\"geo\":{\"bgcolor\":\"white\",\"landcolor\":\"#E5ECF6\",\"subunitcolor\":\"white\",\"showland\":true,\"showlakes\":true,\"lakecolor\":\"white\"},\"title\":{\"x\":0.05},\"mapbox\":{\"style\":\"light\"}}},\"xaxis\":{\"anchor\":\"y\",\"domain\":[0,1],\"title\":{\"text\":\"Feature 1\"}},\"yaxis\":{\"anchor\":\"x\",\"domain\":[0,1],\"title\":{\"text\":\"Feature 2\"}},\"legend\":{\"title\":{\"text\":\"Category\"},\"tracegroupgap\":0},\"title\":{\"text\":\"Künstliche Daten\"}},\"config\":{\"plotlyServerURL\":\"https://plot.ly\"}}","content_type":"application/vnd.plotly.v1+json"}}},"key":"mncI8POONV"}],"key":"llPFskkTGN"}],"key":"wz8N1evViQ"},{"type":"block","children":[],"key":"bCzhkkUh4L"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from sklearn.neural_network import MLPClassifier\nfrom sklearn.model_selection import train_test_split\n\n# Auswahl des Models\n# solver = 'lbfgs' für kleine Datenmengen, solver = 'adam' für große Datenmengen, eher ab 10000\n# hidden_layer: Anzahl der Neuronen pro verdeckte Schicht und Anzahl der verdeckten Schichten\nmodel = MLPClassifier(solver='lbfgs', hidden_layer_sizes=[5, 5])\n\n# Split Trainings- / Testdaten\nX_train, X_test, y_train, y_test = train_test_split(X,y, random_state=0)\n\n# Training\nmodel.fit(X_train, y_train)\n\n# Validierung \nscore_train = model.score(X_train, y_train)\nscore_test = model.score(X_test, y_test)\nprint(f'Score für Trainingsdaten: {score_train:.2f}')\nprint(f'Score für Testdaten: {score_test:.2f}')","key":"RMXI99d6TQ"},{"type":"outputs","id":"rfCQP1YjN3h86FkRMHLdO","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Score für Trainingsdaten: 0.95\nScore für Testdaten: 0.92\n"},"key":"dozrdWH8oX"}],"key":"pbVkKkaFG4"}],"key":"aV022nsEEC"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":80,"column":1},"end":{"line":81,"column":1}},"children":[{"type":"text","value":"Funktioniert gar nicht mal schlecht :-) Wir zeichen die Entscheidungsgrenzen\nein, um zu sehen, wo das neuronale Netz die Trennlinien zieht.","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"key":"XDTaFGOON8"}],"key":"pBWh2tKapB"}],"key":"FzbMds6riB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import plotly.graph_objects as go\nimport numpy as np\nimport pandas as pd\nfrom sklearn.datasets import make_circles\n\n# Generate synthetic data\nX, y = make_circles(noise=0.2, factor=0.5, random_state=1)\n\n# Create grid for contour plot\ngridX, gridY = np.meshgrid(np.linspace(-1.5, 1.5, 50), np.linspace(-1.5, 1.5, 50))\ngridZ = model.predict_proba(np.column_stack([gridX.ravel(), gridY.ravel()]))[:, 1]\nZ = gridZ.reshape(gridX.shape)\n\n# Create scatter plot\nscatter = go.Scatter(x=df['Feature 1'], y=df['Feature 2'], mode='markers',\n                     marker=dict(color=df['Category'], colorscale='BlueRed_r'))\n\n# Create contour plot\ncontour = go.Contour(x=np.linspace(-1.5, 1.5, 50), y=np.linspace(-1.5, 1.5, 50), z=Z, \n                     opacity=0.2, colorscale='BlueRed_r')\n\n# Create figure and add plots\nfig = go.Figure()\nfig.add_trace(contour)\nfig.add_trace(scatter)\nfig.update_layout(title='Künstliche Messdaten und Konturen des Modells',\n                  xaxis_title='Feature 1',\n                  yaxis_title='Feature 2')\nfig.show()","key":"aVFq6XzEi5"},{"type":"outputs","id":"1xb4HMCNMgQsQvgVl2NcE","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"application/vnd.plotly.v1+json":{"content_type":"application/vnd.plotly.v1+json","hash":"12547ce8c269ce1d3f27369b862385fa","path":"/book_ml4ing/build/12547ce8c269ce1d3f27369b862385fa.json"}}},"key":"sQUVfxt51p"}],"key":"vOUb53QLJv"}],"key":"A1PRidbaSR"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":115,"column":1},"end":{"line":118,"column":1}},"children":[{"type":"text","value":"Im Folgenden wollen wir uns ansehen, welche Bedeutung die optionalen Parameter\nhaben. Dazu zunächst noch einmal der komplette Code, aber ohne einen Split in\nTrainings- und Testdaten. Probieren Sie nun unterschiedliche Werte für die\nArchitektur der verdeckten Schicht ‘hidden_layer_sizes’ aus.","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"BdnTQrUlVU"}],"key":"ChlNiCg8hj"}],"key":"F1MvqTBL3Q"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# setze verschiedene Werte für die Architektur der verdeckten Schicht\nmy_hidden_layers = [10,10]\n\n# erzeuge künstliche Daten\nX,y = make_circles(noise=0.2, factor=0.5, random_state=1)\n\n# Auswahl des Model\nmodel = MLPClassifier(solver='lbfgs', hidden_layer_sizes=my_hidden_layers)\n\n# Training und Validierung\nmodel.fit(X, y)\nprint('Score: {:.2f}'.format(model.score(X, y)))\n\n# Visualisierung\n# Create grid for contour plot\ngridX, gridY = np.meshgrid(np.linspace(-1.5, 1.5, 50), np.linspace(-1.5, 1.5, 50))\ngridZ = model.predict_proba(np.column_stack([gridX.ravel(), gridY.ravel()]))[:, 1]\nZ = gridZ.reshape(gridX.shape)\n\n# Create scatter plot\nscatter = go.Scatter(x=df['Feature 1'], y=df['Feature 2'], mode='markers',\n                     marker=dict(color=df['Category'], colorscale='BlueRed_r'))\n\n# Create contour plot\ncontour = go.Contour(x=np.linspace(-1.5, 1.5, 50), y=np.linspace(-1.5, 1.5, 50), z=Z, \n                     opacity=0.2, colorscale='BlueRed_r')\n\n# Create figure and add plots\nfig = go.Figure()\nfig.add_trace(contour)\nfig.add_trace(scatter)\nfig.update_layout(title='Künstliche Messdaten und Konturen des Modells',\n                  xaxis_title='Feature 1',\n                  yaxis_title='Feature 2')\nfig.show()","key":"TIfDEKzQAL"},{"type":"outputs","id":"xPgMCTUduGvG3M5v-_Ja-","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Score: 1.00\n"},"key":"IHQvnsNcGg"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"/opt/homebrew/Caskroom/miniconda/base/envs/python312/lib/python3.12/site-packages/sklearn/neural_network/_multilayer_perceptron.py:546: ConvergenceWarning:\n\nlbfgs failed to converge (status=1):\nSTOP: TOTAL NO. of ITERATIONS REACHED LIMIT.\n\nIncrease the number of iterations (max_iter) or scale the data as shown in:\n    https://scikit-learn.org/stable/modules/preprocessing.html\n\n"},"key":"M1kv7DxLvg"},{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"application/vnd.plotly.v1+json":{"content_type":"application/vnd.plotly.v1+json","hash":"3a3becf4f5db62e3e7cdcbc52ddf7746","path":"/book_ml4ing/build/3a3becf4f5db62e3e7cdcbc52ddf7746.json"}}},"key":"WjWvHAbCUE"}],"key":"IdTjYMuFDR"}],"key":"Z8B8U0zBBT"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":158,"column":1},"end":{"line":164,"column":1}},"children":[{"type":"text","value":"Wie Sie sehen, ist es schwierig, eine gute Architektur des neuronalen Netzes (=\nAnzahl der Neuronen pro verdeckter Schicht und Anzahl verdeckter Schichten) zu\nfinden. Auch fällt das Ergebnis jedesmal ein wenig anders aus, weil\nstochastische Verfahren im Hintergrund für das Trainieren der Gewichte benutzt\nwerden. Aus diesem Grund sollten neuronale Netze nur eingesetzt werden, wenn\nsehr große Datenmengen vorliegen und dann noch ist das Finden der besten\nArchitektur eine große Herausforderung.","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"key":"RLbpBVo2HK"}],"key":"JHIZbiTL2s"}],"key":"hlp3E5D5S7"}],"key":"bFEqGYzT9X"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"12.2 Mehrschichtiges Perzeptron","url":"/chapter12-sec02","group":"12. Neuronale Netze"}}},"domain":"http://localhost:3001"}