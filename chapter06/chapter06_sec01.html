
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Lineare Regression &#8212; Maschinelles Lernen für Studierende der Ingenieurwissenschaften</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/exercise.css" />
    <link rel="stylesheet" type="text/css" href="../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../_static/myadmonitions.css" />
    <link rel="stylesheet" type="text/css" href="../_static/carousel-custom.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Training eines linearen Regressionsmodells" href="chapter06_sec02.html" />
    <link rel="prev" title="Lineare Regression" href="chapter06_sec00.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Maschinelles Lernen für Studierende der Ingenieurwissenschaften</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Willkommen zu ML4ING
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting started...
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter01/chapter01_sec00.html">
   Zu Beginn …
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter01/chapter01_sec01.html">
     Was ist maschinelles Lernen?
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter01/chapter01_sec02.html">
     Technische Voraussetzungen: Python, Anaconda und JupyterLab
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter02/chapter02_sec00.html">
   Crashkurs Python (Teil 1)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter02/chapter02_sec01.html">
     Datentypen, Variablen und Vergleiche
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter02/chapter02_sec02.html">
     Bool, Vergleiche und Programmverzweigung
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter02/chapter02_sec03.html">
     Digitale Logik und Schleife mit Bedingung
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter03/chapter03_sec00.html">
   Crashkurs Python (Teil 2)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter03/chapter03_sec01.html">
     Liste und Zählschleife
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter03/chapter03_sec02.html">
     Funktionen
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter03/chapter03_sec03.html">
     Objektorientierung
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Datenexploration
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter04/chapter04_sec00.html">
   Pandas anstatt Excel
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter04/chapter04_sec01.html">
     Series und DataFrame
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter04/chapter04_sec02.html">
     Arbeiten mit Tabellendaten
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter04/chapter04_sec03.html">
     Statistik mit Pandas
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter05/chapter05_sec00.html">
   Daten visualisieren mit Matplotlib
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter05/chapter05_sec01.html">
     Das Modul NumPy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter05/chapter05_sec02.html">
     Linien-, Balken- und Streudiagramme
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter05/chapter05_sec03.html">
     Visualisierung von DataFrames
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter05/chapter05_sec04.html">
     Optional: Histogramme
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  ML-Verfahren
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="chapter06_sec00.html">
   Lineare Regression
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Lineare Regression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="chapter06_sec02.html">
     Training eines linearen Regressionsmodells
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="chapter06_sec03.html">
     Multiple lineare Regression
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter07/chapter07_sec00.html">
   ML-Workflow
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter07/chapter07_sec01.html">
     Datenvorverarbeitung
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter07/chapter07_sec02.html">
     Modellvalidierung
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter07/chapter07_sec03.html">
     Das Bias-Varianz-Dilemma
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter08/chapter08_sec00.html">
   Perzeptron
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter08/chapter08_sec01.html">
     Grundbaustein neuronaler Netze
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter08/chapter08_sec02.html">
     Die Perzeptron-Lernregel
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter08/chapter08_sec03.html">
     Training eines Perzeptrons mit Scikit-Learn
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter09/chapter09_sec00.html">
   Logistische Regression
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter09/chapter09_sec01.html">
     Logistische Regression ersetzt Perzeptron
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter09/chapter09_sec02.html">
     Logistische Regression lernt mit Maximum-Likelihood
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter09/chapter09_sec03.html">
     Logistische Regression mit Scikit-Learn
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter10/chapter10_sec00.html">
   Support Vector Machine
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter10/chapter10_sec01.html">
     Maximiere den Rand, aber soft
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter10/chapter10_sec02.html">
     Training SVM mit Scikit-Learn
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter10/chapter10_sec03.html">
     Nichtlineare SVM
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter11/chapter11_sec00.html">
   Entscheidungsbäume und Random Forests
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter11/chapter11_sec01.html">
     Entscheidungsbaum
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter11/chapter11_sec03.html">
     Random Forests
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter12/chapter12_sec00.html">
   Neuronale Netze
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
  <label for="toctree-checkbox-12">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter12/chapter12_sec01.html">
     Mehrschichtiges Perzeptron
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter12/chapter12_sec02.html">
     Neuronale Netze mit Scikit-Learn
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/gramschs/book_ml4ing/main?urlpath=lab/tree/docs/chapter06/chapter06_sec01.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        
<button onclick="initThebeSBT()"
  class="headerbtn headerbtn-launch-thebe"
  data-toggle="tooltip"
data-placement="left"
title="Launch Thebe"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="headerbtn__text-container">Live Code</span>
</button>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>
<a href="https://github.com/gramschs/book_ml4ing"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="bottom"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/chapter06/chapter06_sec01.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#lernziele">
   Lernziele
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#regression-kommt-aus-der-statistik">
   Regression kommt aus der Statistik
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#deutscher-gebrauchtwagenmarkt-autoscout24">
   Deutscher Gebrauchtwagenmarkt (Autoscout24)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#scikit-learn-linearregression">
   Scikit-Learn: LinearRegression
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#zusammenfassung">
   Zusammenfassung
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Lineare Regression</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#lernziele">
   Lernziele
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#regression-kommt-aus-der-statistik">
   Regression kommt aus der Statistik
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#deutscher-gebrauchtwagenmarkt-autoscout24">
   Deutscher Gebrauchtwagenmarkt (Autoscout24)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#scikit-learn-linearregression">
   Scikit-Learn: LinearRegression
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#zusammenfassung">
   Zusammenfassung
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="lineare-regression">
<h1>Lineare Regression<a class="headerlink" href="#lineare-regression" title="Permalink to this headline">#</a></h1>
<section id="lernziele">
<h2>Lernziele<a class="headerlink" href="#lernziele" title="Permalink to this headline">#</a></h2>
<div class="hint admonition">
<p class="admonition-title">Lernziele</p>
<ul class="simple">
<li><p>Sie kennen das <strong>lineare Regressionsmodell</strong>.</p></li>
<li><p>Sie können erste grundlegende Schritte der Datenvorverarbeitung anwenden:</p>
<ul>
<li><p>Sie können unvollständige Daten mit <strong>dropna</strong> aus dem Datensatz
entfernen.</p></li>
<li><p>Sie können Ausreißer mit <strong>drop</strong> entfernen.</p></li>
<li><p>Sie können eine Eigenschaft als Input auswählen und mit <strong>reshape</strong> in
Matrixform bringen.</p></li>
</ul>
</li>
<li><p>Sie können ein lineares Regressionsmodell aus Scikit-Learn laden und mit
<strong>fit</strong> trainieren.</p></li>
<li><p>Sie können mit dem trainierten Modell und <strong>predict</strong> eine Prognose abgeben.</p></li>
</ul>
</div>
</section>
<section id="regression-kommt-aus-der-statistik">
<h2>Regression kommt aus der Statistik<a class="headerlink" href="#regression-kommt-aus-der-statistik" title="Permalink to this headline">#</a></h2>
<p>In der Statistik beschäftigen sich Mathematikerinnen und Mathematiker bereits
seit Jahrhunderten damit, Analyseverfahren zu entwickeln, mit denen
experimentelle Daten gut erklärt werden können. Falls wir eine “erklärende”
Variable haben und wir versuchen, die Abhängigkeit einer Messgröße von der
erklärenden Variable zu beschreiben, nennen wir das Regressionsanalyse oder kurz
<strong>Regression</strong>. Bei vielen Problemen suchen wir nach einem linearen Zusammenhang
und sprechen daher von <strong>linearer Regression</strong>. Mehr Details finden Sie auch bei
<a class="reference external" href="https://de.wikipedia.org/wiki/Regressionsanalyse">Wikipedia → Regressionsanalyse</a>.</p>
<p>Etwas präziser formuliert ist lineare Regression ein Verfahren, bei dem es eine
Einflussgröße <span class="math notranslate nohighlight">\(x\)</span> und eine Zielgröße <span class="math notranslate nohighlight">\(y\)</span> mit <span class="math notranslate nohighlight">\(M\)</span> Paaren von dazugehörigen
Messwerten <span class="math notranslate nohighlight">\((x^{(1)},y^{(1)})\)</span>, <span class="math notranslate nohighlight">\((x^{(2)},y^{(2)})\)</span>, <span class="math notranslate nohighlight">\(\ldots\)</span>,
<span class="math notranslate nohighlight">\((x^{(M)},y^{(M)})\)</span> gibt. Dann sollen zwei Koeffizienten <span class="math notranslate nohighlight">\(\omega_0\)</span> und
<span class="math notranslate nohighlight">\(\omega_1\)</span> geschätzt werden, so dass möglichst für alle Datenpunkte <span class="math notranslate nohighlight">\((x^{(i)},
y^{(i)})\)</span> die lineare Gleichung <span class="math notranslate nohighlight">\(y^{(i)} = \omega_0 + \omega_1 x^{(i)}\)</span> gilt.
Geometrisch ausgedrückt: durch die Daten soll eine Gerade gelegt werden. Da bei
den Messungen auch Messfehler auftreten, werden wir die Gerade nicht perfekt
treffen, sondern kleine Fehler machen, die wir hier mit <span class="math notranslate nohighlight">\(\varepsilon^{(i)}\)</span>
bezeichnen. Wir suchen also die beiden Parameter <span class="math notranslate nohighlight">\(\omega_0\)</span> und <span class="math notranslate nohighlight">\(\omega_1\)</span>, so
dass</p>
<div class="math notranslate nohighlight">
\[y^{(i)} = \omega_0 + \omega_1 x^{(i)} + \varepsilon^{(i)}.\]</div>
<p>Die folgende Grafik veranschaulicht das lineare Regressionsmodell. Die Paare von
Daten sind in blau gezeichnet, das lineare Regressionsmodell in rot.</p>
<figure class="align-default" id="fig-linear-regression">
<img alt="../_images/Linear_regression.svg" src="../_images/Linear_regression.svg" /><figcaption>
<p><span class="caption-number">Fig. 3 </span><span class="caption-text">Lineare Regression: die erklärende Variable (= Input oder unabhängige Variable oder Ursache) ist auf der x-Achse, die
abhängige Variable (= Output oder Wirkung) ist auf der y-Achse aufgetragen, Paare von Messungen sind in blau
gekennzeichnet, das Modell in rot.</span><a class="headerlink" href="#fig-linear-regression" title="Permalink to this image">#</a></p>
<div class="legend">
<p>(<a class="reference external" href="https://en.wikipedia.org/wiki/Linear_regression#/media/File:Linear_regression.svg">Quelle:</a> “Example of simple linear regression, which has one independent variable” von Sewaqu. Lizenz: Public domain))</p>
</div>
</figcaption>
</figure>
<p>Zu einer Regressionsanalyse gehört mehr als nur die Regressionskoeffizienten zu
bestimmen. Daten müssen vorverarbeitet werden, unter mehreren unabhängigen
Variablen (Inputs) müssen diejenigen ausgewählt werden, die tatsächlich die
Wirkung erklären. Das lineare Regressionsmodell muss trainiert werden und es
muss getestet werden. Bei den meisten ML-Modellen gibt es noch Modellparameter,
die feinjustiert werden können und die Prognosefähigkeit verbessern.</p>
<p>Im Folgenden erkunden wir einen realistischen Datensatz und bereiten die Daten
für das Training eines linearen Regressionsmodells mit Scikit-Learn vor.</p>
</section>
<section id="deutscher-gebrauchtwagenmarkt-autoscout24">
<h2>Deutscher Gebrauchtwagenmarkt (Autoscout24)<a class="headerlink" href="#deutscher-gebrauchtwagenmarkt-autoscout24" title="Permalink to this headline">#</a></h2>
<p>Um realistische Beispiele zu haben, mit denen wir die lineare Regression
erkunden können, laden wir einen Datensatz mit Daten über den deutschen
Gebrauchtwagenmarkt von 2011 bis 2021 (Autoscout24). Der Datensatz stammt von
<a class="reference external" href="https://www.kaggle.com/datasets/ander289386/cars-germany">Kaggle</a>. Enthalten
sind Daten zu</p>
<ul class="simple">
<li><p>mileage: kilometres traveled by the vehicle (= Kilometerstand)</p></li>
<li><p>make: make of the car (= Marke)</p></li>
<li><p>model: model of the car (= Modell)</p></li>
<li><p>fuel: fuel type (= Treibstoffart)</p></li>
<li><p>gear: manual or automatic (= Getriebe)</p></li>
<li><p>offerType: type of offer (new, used, …) (= Angebotsart)</p></li>
<li><p>price: sale price of the vehicle (= Gebrauchtpreis)</p></li>
<li><p>hp: horse power (= PS)</p></li>
<li><p>year: the vehicle registration year (= Baujahr)</p></li>
</ul>
<p>Wie immer laden wir die Daten und verschaffen uns zunächst einen Überblick.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">data_raw</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/autoscout24-germany-dataset.csv&#39;</span><span class="p">)</span>
<span class="n">data_raw</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 46405 entries, 0 to 46404
Data columns (total 9 columns):
 #   Column     Non-Null Count  Dtype  
---  ------     --------------  -----  
 0   mileage    46405 non-null  int64  
 1   make       46405 non-null  object 
 2   model      46262 non-null  object 
 3   fuel       46405 non-null  object 
 4   gear       46223 non-null  object 
 5   offerType  46405 non-null  object 
 6   price      46405 non-null  int64  
 7   hp         46376 non-null  float64
 8   year       46405 non-null  int64  
dtypes: float64(1), int64(3), object(5)
memory usage: 3.2+ MB
</pre></div>
</div>
</div>
</div>
<p>Offensichtlich sind in den Spalten ‘model’, ‘gear’ und ‘hp’ einige Datensätze
nicht vollständig. Das erkennen wir daran, dass insgesmt 46.405 Einträge
vorliegen, aber in diesen drei Spalten weniger erfasst sind.</p>
<p>Wir machen es uns jetzt einfach und entfernen die nicht vollständigen Daten aus
unserem Datensatz mit der Methode <code class="docutils literal notranslate"><span class="pre">.dropna()</span></code>, siehe <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.dropna.html">Scikit-Learn
(Dokumentation
dropna)</a>.
Bei einem echten Industrieprojekt müssten wir dem Problem nachgehen und die
fehlenden Daten beschaffen. Sollte das nicht gehen, so müssten wir als nächstes
analysieren, warum die Daten fehlen, ob beispielsweise eine Systematik
dahintersteckt, und uns dann einen geeigneten Plan machen, wie mit den fehlenden
Daten umzugehen ist. Das ist ein eigenständiges Thema innerhalb des ML, auf das
wir im nächsten Kapitel noch näher eingehen werden.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">data_raw</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">data</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Int64Index: 46071 entries, 0 to 46404
Data columns (total 9 columns):
 #   Column     Non-Null Count  Dtype  
---  ------     --------------  -----  
 0   mileage    46071 non-null  int64  
 1   make       46071 non-null  object 
 2   model      46071 non-null  object 
 3   fuel       46071 non-null  object 
 4   gear       46071 non-null  object 
 5   offerType  46071 non-null  object 
 6   price      46071 non-null  int64  
 7   hp         46071 non-null  float64
 8   year       46071 non-null  int64  
dtypes: float64(1), int64(3), object(5)
memory usage: 3.5+ MB
</pre></div>
</div>
</div>
</div>
<p>In dem Datensatz gibt es nur vier Eigenschaften, die numerisch sind, also in
Form von Zahlen repräsentiert werden. Wir wählen die Eigenschaft Preis als
Zielgröße (=abhängige Variable oder Wirkung oder Output).</p>
<p>Als nächstes erkunden wir, wie der Preis abhängig von den Inputs</p>
<ul class="simple">
<li><p>Kilometerstand,</p></li>
<li><p>Baujahr und</p></li>
<li><p>PS</p></li>
</ul>
<p>ist, indem wir die Daten plotten. Wir fangen mit dem Kilometerstand der Autos an.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># extract data</span>
<span class="n">x_km</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;mileage&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># plot</span>
<span class="kn">import</span> <span class="nn">matplotlib.pylab</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;bmh&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.family&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;TeX Gyre Heros&#39;</span><span class="p">,</span> <span class="s1">&#39;sans-serif&#39;</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_km</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Kilometerstand&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Preis&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Gebrauchtwagenmarkt 2011-2021 (Autoscout24)&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/chapter06_sec01_8_0.png" src="../_images/chapter06_sec01_8_0.png" />
</div>
</div>
<p>Zunächst einmal stören die Ausreißer etwas. Wir suchen zuerst mal nach
den Einträgen mit Preisen über eine halbe Mio. Euro.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">filter</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;price&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">500000</span>
<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="nb">filter</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mileage</th>
      <th>make</th>
      <th>model</th>
      <th>fuel</th>
      <th>gear</th>
      <th>offerType</th>
      <th>price</th>
      <th>hp</th>
      <th>year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>11753</th>
      <td>90</td>
      <td>Maybach</td>
      <td>Pullman</td>
      <td>Gasoline</td>
      <td>Automatic</td>
      <td>Used</td>
      <td>717078</td>
      <td>630.0</td>
      <td>2019</td>
    </tr>
    <tr>
      <th>11754</th>
      <td>90</td>
      <td>Mercedes-Benz</td>
      <td>S 650</td>
      <td>Gasoline</td>
      <td>Automatic</td>
      <td>Used</td>
      <td>717078</td>
      <td>630.0</td>
      <td>2019</td>
    </tr>
    <tr>
      <th>21675</th>
      <td>431</td>
      <td>Ferrari</td>
      <td>F12</td>
      <td>Gasoline</td>
      <td>Automatic</td>
      <td>Used</td>
      <td>1199900</td>
      <td>775.0</td>
      <td>2017</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Wahrscheinlich handelt es sich bei Eintrag 11753 und 11754 ohnehin um das
gleiche Fahrzeug. Wir entfernen die drei Einträge mit der <code class="docutils literal notranslate"><span class="pre">drop()</span></code>-Methode,
siehe <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.drop.html">Pandas Dokumentation
(drop)</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="mi">11753</span><span class="p">,</span> <span class="mi">11754</span><span class="p">,</span> <span class="mi">21675</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># data</span>
<span class="n">x_km</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;mileage&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_km</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Kilometerstand&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Preis&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Gebrauchtwagenmarkt2011-2021 (Autoscout24)&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/chapter06_sec01_13_0.png" src="../_images/chapter06_sec01_13_0.png" />
</div>
</div>
<p>Sieht nicht besonders linear aus, eher wie eine Hyperbel. Als nächstes
betrachten wir den Preis in Abhängigkeit des Baujahrs.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># data</span>
<span class="n">x_bj</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_bj</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Baujahr&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Preis&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Gebrauchtwagenmarkt 2011-2021 (Autoscout24)&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/chapter06_sec01_15_0.png" src="../_images/chapter06_sec01_15_0.png" />
</div>
</div>
<p>Je jünger, desto teurer, könnte linear sein. Und zuletzt visualisieren wir den
Preis abhängig von der PS-Zahl.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># data</span>
<span class="n">x_ps</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;hp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_ps</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;PS&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Preis&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Gebrauchtwagenmarkt 2011-2021 (Autoscout24)&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/chapter06_sec01_17_0.png" src="../_images/chapter06_sec01_17_0.png" />
</div>
</div>
<p>Bei dem Input PS scheint es eine lineare Abhängigkeit zu geben. Je mehr PS desto
teurer.</p>
</section>
<section id="scikit-learn-linearregression">
<h2>Scikit-Learn: LinearRegression<a class="headerlink" href="#scikit-learn-linearregression" title="Permalink to this headline">#</a></h2>
<p>Die Bestimmung der Koeffizienten <span class="math notranslate nohighlight">\(\omega_0\)</span> und <span class="math notranslate nohighlight">\(\omega_1\)</span> der Geraden <span class="math notranslate nohighlight">\(y^{(i)}
= \omega_0 + \omega x^{(i)}\)</span> funktioniert nicht mehr händisch. Natürlich wäre es
möglich, solange Steigungen <span class="math notranslate nohighlight">\(\omega_1\)</span> und y-Achsenabschnitte <span class="math notranslate nohighlight">\(\omega_0\)</span> zu
raten, bis eine Gerade herauskommt, die annähernd passt. Scikit-Learn liefert
uns sogar die beste Gerade, wobei wir noch diskutieren müssen, was “die beste”
genau heißt.</p>
<p>Um Scikit-Learn arbeiten zu lassen, importieren wir die linearen
Regressionsmodelle <code class="docutils literal notranslate"><span class="pre">LinearRegression</span></code> aus dem Modul <code class="docutils literal notranslate"><span class="pre">sklearn.linear_model</span></code>.
Danach initialiseren wir das Modell und speichern es in der Variable <code class="docutils literal notranslate"><span class="pre">model</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Mit der Methode <code class="docutils literal notranslate"><span class="pre">.fit()</span></code> werden die Koeffizienten des Modells an die Daten
angepasst. Dazu müssen die Daten in einem bestimmten Format vorliegen. Bei den
Inputs wird davon ausgegangen, dass mehrere Eigenschaften in das Modell eingehen
sollen. Die Eigenschaften stehen normalerweise in den Spalten des Datensatzes.
Beim Output erwarten wir zunächst nur eine Eigenschaft, die durch das Modell
erklärt werden soll. Daher geht Scikit-Learn davon aus, dass der Input eine
Matrix <span class="math notranslate nohighlight">\(X\)</span> ist, die M Zeilen und N Spalten hat. M ist die Anzahl an Daten, hier
also die Anzahl der Autos, und N ist die Anzahl der Eigenschaften, die
betrachtet werden sollen. Da wir momentan nur die Abhängigkeit des Preises von
der PS-Zahl analysieren wollen, ist <span class="math notranslate nohighlight">\(N=1\)</span>. Beim Output geht Scikit-Learn davon
aus, dass ein eindimensionaler Spaltenvektor vorliegt, der natürlich ebenfalls M
Zeilen hat. Wir müssen daher unsere PS-Zahlen noch in das Matrix-Format bringen.
Dazu verwenden wir aus dem Numpy-Modul die <code class="docutils literal notranslate"><span class="pre">.reshape()</span></code> Methode, siehe
<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.reshape.html">Numpy-Dokumentation →
reshape</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Konvertiere in Matrix-Format</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">x_ps</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1">#  Training des linearen Regressionsmodells</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p>Nachdem das lineare Regressionsmodell trainiert wurde, können wir die Steigung
in dem Attribut <code class="docutils literal notranslate"><span class="pre">.coef_</span></code>ablesen und den y-Achsenabschnitt in dem Attribut
<code class="docutils literal notranslate"><span class="pre">.intercept_</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Steigung: &#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">coef_</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;y-Achsenabschnitt: &#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">intercept_</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Steigung: 
[186.80491242]
y-Achsenabschnitt: 
-8330.026523879089
</pre></div>
</div>
</div>
</div>
<p>Damit könnten wir eine Geradengleichung aufstellen und eine Funktion
implementieren, um für eine PS-Zahl eine Prognose abzugeben, welchen
Verkauspreis das Auto erzielen könnte. Aber tatsächlich hat das Scikit-Learn für
uns schon erledigt. Die Methode <code class="docutils literal notranslate"><span class="pre">.predict()</span></code> berechnet mit den intern
gespeicherten Koeffizienten des linearen Regressionsmodells eine Prognose. Für
eine PS-Zahl von 80 Ps wird ein Verkaufspreis von</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">([[</span><span class="mi">80</span><span class="p">]])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([6614.36646953])
</pre></div>
</div>
</div>
</div>
<p>6.614 EUR erzielt. Denken Sie daran, dass eine Matrix als Input übergeben werden
muss.</p>
<p>Damit können wir auch eine Wertetabelle für PS-Zahlen von 0 bis 800 PS
aufstellen und das Ergebnis zusammen mit den tatsächlichen Verkaufspreisen
visualisieren.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">X_predict</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">800</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y_predict</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_predict</span><span class="p">)</span>

<span class="c1"># plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_ps</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_predict</span><span class="p">,</span> <span class="n">y_predict</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;PS&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Preis&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Gebrauchtwagenpreise 2011-2021 (Autoscout24)&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/chapter06_sec01_28_0.png" src="../_images/chapter06_sec01_28_0.png" />
</div>
</div>
</section>
<section id="zusammenfassung">
<h2>Zusammenfassung<a class="headerlink" href="#zusammenfassung" title="Permalink to this headline">#</a></h2>
<p>In diesem Abschnitt haben Sie das theoretische Modell der linearen Regression
kennengelernt. Um mit einem realistischen Datensatz zu arbeiten, haben wir einen
Datensatz von Kaggle importiert und die Daten vorverarbeitet. Danach haben wir
mit Scikit-Learn ein lineare Regressionsmodell trainiert und damit eine Prognose
erstellt.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "gramschs/book_ml4ing",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./chapter06"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="chapter06_sec00.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Lineare Regression</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="chapter06_sec02.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Training eines linearen Regressionsmodells</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Simone Gramsch<br/>
  
    <div class="extra_footer">
      <div>
<a href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img class="license" alt="Creative Commons License" src="https://i.creativecommons.org/l/by-nc-sa/4.0/80x15.png" /></a> This book is licensed under a <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons BY-NC-SA 4.0 License</a>.
</div>

    </div>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>