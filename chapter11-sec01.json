{"version":3,"kind":"Notebook","sha256":"ffdd6681b5201e63f15c2fb4cb2c040bd7c77b94073b2de78b4ca8705222f0ca","slug":"chapter11-sec01","location":"/chapter11/chapter11_sec01.md","dependencies":[],"frontmatter":{"title":"11.1 Kreuzvalidierung","kernelspec":{"name":"python3","display_name":"Python 3","language":"python"},"jupytext":{"formats":"ipynb,md:myst","text_representation":{"extension":".md","format_name":"myst","format_version":"0.13","jupytext_version":"1.15.2"}},"content_includes_title":false,"authors":[{"id":"Simone Gramsch","name":"Simone Gramsch"}],"open_access":true,"license":{"content":{"id":"CC-BY-NC-SA-4.0","url":"https://creativecommons.org/licenses/by-nc-sa/4.0/","name":"Creative Commons Attribution Non Commercial Share Alike 4.0 International","CC":true}},"github":"https://github.com/gramschs/book_ml4ing","numbering":{"title":{"offset":1}},"source_url":"https://github.com/gramschs/book_ml4ing/blob/main/chapter11/chapter11_sec01.md","edit_url":"https://github.com/gramschs/book_ml4ing/edit/main/chapter11/chapter11_sec01.md","exports":[{"format":"md","filename":"chapter11_sec01.md","url":"/book_ml4ing/build/chapter11_sec01-1225fed0b8e68d25bc672dab94e262d4.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":18,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"text","value":"In der Praxis ist es entscheidend, dass ein ML-Modell nicht nur gute Prognosen\nfür die Daten liefert, sondern auch für neue, unbekannte Daten zuverlässig\nfunktioniert. Durch das Aufteilen der Daten in Trainings- und Testdaten können\nwir eine erste Einschätzung über die Verallgemeinerungsfähigkeit eines Modells\ntreffen. Dieser Ansatz weist jedoch einige Schwächen auf, die wir in diesem\nKapitel näher beleuchten. Im Anschluss lernen wir ein fortschrittlicheres\nVerfahren kennen: die Kreuzvalidierung, die über die einfache Aufteilung in\nTrainings- und Testdaten hinausgeht und eine robustere Bewertung der\nModellleistung ermöglicht.","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"XW2GBQggTD"}],"key":"lj5i7SwPD5"},{"type":"heading","depth":2,"position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"text","value":"Lernziele","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"E9ZsQp4Xiv"}],"identifier":"lernziele","label":"Lernziele","html_id":"lernziele","implicit":true,"key":"L7ksIgFbGK"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Lernziele","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"yFXBp3v5Xf"}],"key":"CxIbtE3a2H"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":32,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":32,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Sie sind in der Lage, das Konzept der ","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"ByVU02N0mc"},{"type":"strong","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"text","value":"Kreuzvalidierung (Cross Validation)","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"YpbnGhprKd"}],"key":"xbiYAyuK4a"},{"type":"text","value":"\nverständlich zu erklären.","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"jGX3dTaWK1"}],"key":"kSk8w4MSVb"}],"key":"GZx0MwXr8C"},{"type":"listItem","spread":true,"position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Sie können die Vor- und Nachteile der Kreuzvalidierung aufzählen und bewerten.","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"VhEcujJUjr"}],"key":"zY6B9dPSk7"}],"key":"acAXnVJysM"},{"type":"listItem","spread":true,"position":{"start":{"line":35,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Sie können mit ","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"K6sGudbj6p"},{"type":"strong","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"text","value":"KFold","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"k5ylOEdYRI"}],"key":"a0de2CEQ4n"},{"type":"text","value":" einen Datensatz in verschiedene ","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"Ru3t3y8yXz"},{"type":"strong","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"text","value":"Teilmengen\n(Folds)","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"g2lMcEpW2k"}],"key":"m1SAusf2aM"},{"type":"text","value":" aufteilen.","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"c1LZChXQu0"}],"key":"irHGGj4cYy"}],"key":"iSlh687USQ"},{"type":"listItem","spread":true,"position":{"start":{"line":37,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Sie beherrschen die Durchführung einer Kreuzvalidierung mithilfe der Funktion\n","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"O5NvNfuTXG"},{"type":"strong","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"children":[{"type":"text","value":"cross_validate()","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"XQLKCR9Ekk"}],"key":"koP9cZtNUk"},{"type":"text","value":".","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"hYFvaqF7oJ"}],"key":"S5bKR9K7UO"}],"key":"SC1YjZiINB"}],"key":"CStxdTMS5l"}],"class":"attention","key":"cCR6dREcPY"},{"type":"heading","depth":2,"position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"children":[{"type":"text","value":"Idee der Kreuzvalidierung","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"key":"InNCiPQZe5"}],"identifier":"idee-der-kreuzvalidierung","label":"Idee der Kreuzvalidierung","html_id":"idee-der-kreuzvalidierung","implicit":true,"key":"NkIHgjAJwF"},{"type":"paragraph","position":{"start":{"line":43,"column":1},"end":{"line":51,"column":1}},"children":[{"type":"text","value":"Ein zentraler Schritt im ML-Workflow ist die Aufteilung der Daten in einen\nTrainings- und einen Testdatensatz. Das Modell wird auf den Trainingsdaten\ntrainiert und anschließend auf den Testdaten bewertet. Diese Methode hat jedoch\nauch Nachteile. Besonders bei kleinen Datensätzen ist es problematisch,\nbeispielsweise 25 % der Daten für den Test zurückhalten zu müssen, da dies die\nDatenmenge für das Training reduziert. Zudem kann eine zufällige Aufteilung der\nDaten zu unbalancierten Splits führen, die die Trainings- und Testergebnisse\nverfälschen. Eine sinnvolle Alternative zu dieser simplen Aufteilung ist die\n","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"vMXDGPAlVA"},{"type":"strong","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"children":[{"type":"text","value":"Kreuzvalidierung","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"G4iDlcOQpV"}],"key":"ZMGECBR7Wv"},{"type":"text","value":" (engl. ","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"Csu5k6fkLO"},{"type":"strong","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"children":[{"type":"text","value":"Cross Validation","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"oFTJM6RLTH"}],"key":"bT9tfMRGh3"},{"type":"text","value":").","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"T5WKzcTiJC"}],"key":"pEjjdk6CLA"},{"type":"paragraph","position":{"start":{"line":53,"column":1},"end":{"line":62,"column":1}},"children":[{"type":"text","value":"Bei der Kreuzvalidierung werden die Daten in mehrere ","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"dbWvKQ3xhe"},{"type":"strong","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"text","value":"Teilmengen","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"rGLSRTWA6g"}],"key":"kBiiGsFtGv"},{"type":"text","value":", sogenannte\n","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"dVdle9ZQ2c"},{"type":"strong","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"text","value":"Folds","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"C0OhQFsFZW"}],"key":"bq8QN6LANN"},{"type":"text","value":", aufgeteilt. Beispielsweise können die Daten in fünf Folds unterteilt\nwerden. Das Modell wird dann fünfmal trainiert und getestet, wobei in jedem\nDurchlauf eine andere Teilmenge als Testdaten verwendet wird. Im ersten\nDurchlauf wird etwa Fold A für den Test zurückgehalten, während die Folds B, C,\nD und E zum Training genutzt werden. Im zweiten Durchlauf wird Fold B als\nTestdatensatz verwendet und die restlichen Folds dienen wieder dem Training.\nDieser Prozess wird so lange wiederholt, bis jeder Fold einmal als Testdaten\nfungiert hat. Am Ende wird die Modellleistung (Score) als Durchschnitt der\nErgebnisse aus den fünf Durchläufen berechnet.","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"vBCwgxJquB"}],"key":"e0tIg6Xqfg"},{"type":"paragraph","position":{"start":{"line":64,"column":1},"end":{"line":70,"column":1}},"children":[{"type":"text","value":"Es müssen jedoch nicht zwingend fünf Folds verwendet werden. Oftmals werden die\nDaten in zehn Folds aufgeteilt, sodass 90 % der Daten zum Training und 10 % für\nden Test verwendet werden. Ein weiterer Vorteil ist, dass jeder Datenpunkt im\nLaufe der Kreuzvalidierung sowohl im Training als auch im Test berücksichtigt\nwird, jedoch nie gleichzeitig. Dies verringert die Gefahr, dass unausgewogene\nDaten zu verzerrten Testergebnissen führen, wie es bei einer zufälligen\nAufteilung passieren könnte.","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"key":"L9oovf6aOt"}],"key":"uUwphuKia7"},{"type":"paragraph","position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"children":[{"type":"text","value":"Zusammengefasst bietet die Kreuzvalidierung mehrere Vorteile:","position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"key":"IUAfRoC6is"}],"key":"fNcOgq5O9s"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":74,"column":1},"end":{"line":81,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":74,"column":1},"end":{"line":76,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"children":[{"type":"text","value":"Effizientere Datennutzung","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"key":"fGAD2rKIYu"}],"key":"p7gSzw65H3"},{"type":"text","value":": Jeder Datenpunkt wird mindestens einmal als\nTestdatenpunkt verwendet, was besonders bei kleinen Datensätzen wichtig ist,\nda die Daten optimal ausgenutzt werden.","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"key":"JaBEWOPjEV"}],"key":"i2ekE6tha7"}],"key":"PogtsywCq4"},{"type":"listItem","spread":true,"position":{"start":{"line":77,"column":1},"end":{"line":81,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"children":[{"type":"text","value":"Stabilere Schätzung der Modellleistung","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"key":"HiJYYYHvpN"}],"key":"KHl4hRN8lj"},{"type":"text","value":": Durch das wiederholte Training und\nTesten auf verschiedenen Daten erhöht sich die Robustheit der geschätzten\nModellleistung (Score), da zufällige Verzerrungen durch unbalancierte Splits\nminimiert werden.","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"key":"tbVKtzzZ57"}],"key":"dFYIPHzL8M"}],"key":"o7PpxhhYpA"}],"key":"Mky8PjeYef"},{"type":"paragraph","position":{"start":{"line":82,"column":1},"end":{"line":83,"column":1}},"children":[{"type":"text","value":"Ein Nachteil der Kreuzvalidierung ist der erhöhte Rechenaufwand, da das Modell\nmehrfach trainiert und getestet wird.","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"key":"MJqvXUuGIr"}],"key":"USrrJ1gOfi"},{"type":"paragraph","position":{"start":{"line":85,"column":1},"end":{"line":88,"column":1}},"children":[{"type":"text","value":"Können wir also auf die Aufteilung in Trainings- und Testdaten verzichten? Nein,\ndenn für das Hyperparameter-Tuning ist der Split weiterhin notwendig. Mehr dazu\nim nächsten Kapitel. Zunächst widmen wir uns der praktischen Umsetzung der\nKreuzvalidierung in Scikit-Learn.","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"key":"WplpAbT5XC"}],"key":"FR95Vi0Nso"},{"type":"heading","depth":2,"position":{"start":{"line":90,"column":1},"end":{"line":90,"column":1}},"children":[{"type":"text","value":"Kreuzvalidierung mit KFold","position":{"start":{"line":90,"column":1},"end":{"line":90,"column":1}},"key":"u4GQg03mh2"}],"identifier":"kreuzvalidierung-mit-kfold","label":"Kreuzvalidierung mit KFold","html_id":"kreuzvalidierung-mit-kfold","implicit":true,"key":"JzHpND4E81"},{"type":"paragraph","position":{"start":{"line":92,"column":1},"end":{"line":96,"column":1}},"children":[{"type":"text","value":"Um die Kreuzvalidierung in Scikit-Learn zu demonstrieren, generieren wir\nzunächst einen künstlichen Datensatz. Mithilfe der Funktion ","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"key":"Nj6vreqywX"},{"type":"inlineCode","value":"make_moons()","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"key":"Xt6SHETZy0"},{"type":"text","value":"\nerstellen wir 50 Datenpunkte und speichern sie in einem Pandas-DataFrame. Für\neine einfachere Visualisierung mit Plotly Express wandeln wir die Zielvariable\n","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"key":"HTxGiKG79o"},{"type":"inlineCode","value":"'Wirkung'","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"key":"i5UeupOK1V"},{"type":"text","value":" von den Werten 0/1 in boolesche Werte (False/True) um.","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"key":"CO0uVBb9YC"}],"key":"O7MOmD0AgP"}],"key":"hvmKdkcD2q"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import pandas as pd\nimport plotly.express as px\nfrom sklearn.datasets import make_moons \n\nX_array, y_array = make_moons(noise = 0.5, n_samples=50, random_state=3)\ndaten = pd.DataFrame({\n    'Merkmal 1': X_array[:,0],\n    'Merkmal 2': X_array[:,1],\n    'Wirkung': y_array\n})\ndaten['Wirkung'] = daten['Wirkung'].astype('bool')\n\nfig = px.scatter(daten, x = 'Merkmal 1', y = 'Merkmal 2', color='Wirkung',\n    title='Künstliche Daten')\nfig.show()","key":"WLeMhtpYbd"},{"type":"outputs","id":"FxsyW7xDo5J-u_IIjcLpU","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"application/vnd.plotly.v1+json":{"content":"{\"data\":[{\"hovertemplate\":\"Wirkung=False<br>Merkmal 1=%{x}<br>Merkmal 2=%{y}<extra></extra>\",\"legendgroup\":\"False\",\"marker\":{\"color\":\"#636efa\",\"symbol\":\"circle\"},\"mode\":\"markers\",\"name\":\"False\",\"orientation\":\"v\",\"showlegend\":true,\"x\":{\"dtype\":\"f8\",\"bdata\":\"Kyn0wJPq5T/3erIeTFvmP3XtLEoMurm/vMRYFkE59j9NMz7jZAvhPxFPUxwKmO2/tMRrUDtE4j9izvuqe9Pfv2hDzsJcat6/drz23eA63795Jn4ETinqP4y2mXK3etw/hJcGuiVz5z+6GfAq16fxPwRv21F8v/O/fW3Lm9/46D+fDWkbpEDmvzcxW+1Rb++/cfYMEkI33D9DWINCdTjtv3jGx1fnuuC/PSXnlpvk7D/2MAJSssv4P4Bctm+/ufU/cNOc65T6qr8=\"},\"xaxis\":\"x\",\"y\":{\"dtype\":\"f8\",\"bdata\":\"dz5Uixhq6T9+/gYT3jn6P6irh9nbKO4/BxKzMbSb4z8uMCOgoa7Rv4XDqztQEtQ/bcDcepwI8D95Ml4PzFHkPx8FVQYLnfE/MwcjJud6+T88v0DvGwbUv5bctWXbF/E/YSPbqxW+3D8R4jlNz332v+6LD+XQsMa/v4uup/dj6z+zRQyqjHLfP5IciCYrh+M/jQr2+lAc8j+e/sb20UfWP8nJKjRaONw/rEKUXI/A2r9Ds3wJ7yzyPyqqSg0ND8I/2CtVR+3Bj78=\"},\"yaxis\":\"y\",\"type\":\"scatter\"},{\"hovertemplate\":\"Wirkung=True<br>Merkmal 1=%{x}<br>Merkmal 2=%{y}<extra></extra>\",\"legendgroup\":\"True\",\"marker\":{\"color\":\"#EF553B\",\"symbol\":\"circle\"},\"mode\":\"markers\",\"name\":\"True\",\"orientation\":\"v\",\"showlegend\":true,\"x\":{\"dtype\":\"f8\",\"bdata\":\"N4b9Lz4n+T9BttSQTxACQH/YE7oD0OY/gLrBfeWLxL/Fs4m6F7n7P+5T11AD9v8/Gt8j0fXz9D+JhQUMiLDwP3pUT0nJA3+/a+OkjkvC5z/Oqo11sxsAQGqlcLT78+A/Se+gHdd71T+FdeuOCa4AQGLymlXnR/w/kkqs23W92T8gHlJkbdnoP4ath7jZJ+I/MHP8pq1X1j+s+8vIdofAPzRHZoIvzPY/oklfvmDb+z9/+CjEvCT4P/7qg0swPABAJcmuI04EAUA=\"},\"xaxis\":\"x\",\"y\":{\"dtype\":\"f8\",\"bdata\":\"PE44/HAq9r/a/NGNXqfUvzgIV61ihZe/8M7NuCV65j+Kc8KPQaf0P4aDP/gyAPK/kiqXFXxA57+MwpJUoEbDPxDRQhJnyNI/5C5Pk6s90z+0dPNN1VDiv5oKJ/2gXtU/nKXXIFTzwT88IuctcTPNP+IupAsWTdM/stDNiAeYxr+PyMY2MgDhv8gfClyswNu/TI9i9/8vwb+EUozdtXTzP3ic1lFd5+e/3VcmnF8C57/AgnJ5ly/yP/gBhI3ERqs/9McMbTlQ3T8=\"},\"yaxis\":\"y\",\"type\":\"scatter\"}],\"layout\":{\"template\":{\"data\":{\"histogram2dcontour\":[{\"type\":\"histogram2dcontour\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1,\"#f0f921\"]]}],\"choropleth\":[{\"type\":\"choropleth\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"histogram2d\":[{\"type\":\"histogram2d\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1,\"#f0f921\"]]}],\"heatmap\":[{\"type\":\"heatmap\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1,\"#f0f921\"]]}],\"contourcarpet\":[{\"type\":\"contourcarpet\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"contour\":[{\"type\":\"contour\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1,\"#f0f921\"]]}],\"surface\":[{\"type\":\"surface\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1,\"#f0f921\"]]}],\"mesh3d\":[{\"type\":\"mesh3d\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"scatter\":[{\"fillpattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2},\"type\":\"scatter\"}],\"parcoords\":[{\"type\":\"parcoords\",\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterpolargl\":[{\"type\":\"scatterpolargl\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"bar\":[{\"error_x\":{\"color\":\"#2a3f5f\"},\"error_y\":{\"color\":\"#2a3f5f\"},\"marker\":{\"line\":{\"color\":\"#E5ECF6\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"scattergeo\":[{\"type\":\"scattergeo\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterpolar\":[{\"type\":\"scatterpolar\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"scattergl\":[{\"type\":\"scattergl\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatter3d\":[{\"type\":\"scatter3d\",\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scattermap\":[{\"type\":\"scattermap\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scattermapbox\":[{\"type\":\"scattermapbox\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterternary\":[{\"type\":\"scatterternary\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scattercarpet\":[{\"type\":\"scattercarpet\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"minorgridcolor\":\"white\",\"startlinecolor\":\"#2a3f5f\"},\"baxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"minorgridcolor\":\"white\",\"startlinecolor\":\"#2a3f5f\"},\"type\":\"carpet\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#EBF0F8\"},\"line\":{\"color\":\"white\"}},\"header\":{\"fill\":{\"color\":\"#C8D4E3\"},\"line\":{\"color\":\"white\"}},\"type\":\"table\"}],\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"#E5ECF6\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}]},\"layout\":{\"autotypenumbers\":\"strict\",\"colorway\":[\"#636efa\",\"#EF553B\",\"#00cc96\",\"#ab63fa\",\"#FFA15A\",\"#19d3f3\",\"#FF6692\",\"#B6E880\",\"#FF97FF\",\"#FECB52\"],\"font\":{\"color\":\"#2a3f5f\"},\"hovermode\":\"closest\",\"hoverlabel\":{\"align\":\"left\"},\"paper_bgcolor\":\"white\",\"plot_bgcolor\":\"#E5ECF6\",\"polar\":{\"bgcolor\":\"#E5ECF6\",\"angularaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"radialaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"}},\"ternary\":{\"bgcolor\":\"#E5ECF6\",\"aaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"caxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"}},\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"sequential\":[[0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1,\"#f0f921\"]],\"sequentialminus\":[[0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1,\"#f0f921\"]],\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]]},\"xaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"white\",\"automargin\":true,\"zerolinewidth\":2},\"yaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"white\",\"automargin\":true,\"zerolinewidth\":2},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2},\"yaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2},\"zaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2}},\"shapedefaults\":{\"line\":{\"color\":\"#2a3f5f\"}},\"annotationdefaults\":{\"arrowcolor\":\"#2a3f5f\",\"arrowhead\":0,\"arrowwidth\":1},\"geo\":{\"bgcolor\":\"white\",\"landcolor\":\"#E5ECF6\",\"subunitcolor\":\"white\",\"showland\":true,\"showlakes\":true,\"lakecolor\":\"white\"},\"title\":{\"x\":0.05},\"mapbox\":{\"style\":\"light\"}}},\"xaxis\":{\"anchor\":\"y\",\"domain\":[0,1],\"title\":{\"text\":\"Merkmal 1\"}},\"yaxis\":{\"anchor\":\"x\",\"domain\":[0,1],\"title\":{\"text\":\"Merkmal 2\"}},\"legend\":{\"title\":{\"text\":\"Wirkung\"},\"tracegroupgap\":0},\"title\":{\"text\":\"Künstliche Daten\"}},\"config\":{\"plotlyServerURL\":\"https://plot.ly\"}}","content_type":"application/vnd.plotly.v1+json"}}},"key":"rg4noHnBGL"}],"key":"heecJZjmGG"}],"key":"oX62P3ZCSR"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":116,"column":1},"end":{"line":121,"column":1}},"children":[{"type":"text","value":"Als Nächstes laden wir die Klasse ","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"key":"q8FzGxtOOS"},{"type":"inlineCode","value":"KFold","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"key":"cPTQ6ar2RD"},{"type":"text","value":" aus dem Untermodul\n","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"key":"jXNh0MRdy2"},{"type":"inlineCode","value":"sklearn.model_selection","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"key":"DouKLNFYTz"},{"type":"text","value":". Wir instanziieren ein KFold-Objekt mit dem Argument\n","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"key":"z5DxcwNIIT"},{"type":"inlineCode","value":"n_splits=5","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"key":"wwD3QoGTu4"},{"type":"text","value":", das die Daten in fünf Teilmengen (Folds) aufteilt. Tatsächlich ist\ndies die Standardeinstellung, wie uns die ","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"key":"T8gLkxcbVU"},{"type":"link","url":"https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.KFold.html","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"children":[{"type":"text","value":"Dokumentation Scikit-Learn →\nKFold","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"key":"VA6px6vwYd"}],"urlSource":"https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.KFold.html","key":"MMtTE2viKg"},{"type":"text","value":"\nzeigt. Das Argument könnte also weggelassen werden.","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"key":"zp1OGldw5y"}],"key":"EXPE3APZ8y"}],"key":"FhbWe9BMeZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from sklearn.model_selection import KFold\n\nkfold = KFold(n_splits = 5)","key":"XGnB148zG9"},{"type":"outputs","id":"BSLoCZkKzBhq0MSY4rgWC","children":[],"key":"Y57utSwUg4"}],"key":"hR3yHW8wP3"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":129,"column":1},"end":{"line":131,"column":1}},"children":[{"type":"text","value":"Im Hintergrund wurde ein Generator erzeugt, mit Hilfe dessen wir Daten in fünf\nTeilmengen (Folds) aufteilen können. Dazu benutzen wir die Methode ","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"OQTzWMR4gj"},{"type":"inlineCode","value":".split()","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"dqOt3cO9Dv"},{"type":"text","value":"\nund übergeben ihr die Daten, die gesplittet werden sollen.","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"wPWVrNCJYy"}],"key":"ZRDhV76Rdk"}],"key":"zeHDbup6wg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"kfold.split(daten)","key":"H1MaQgNr2c"},{"type":"outputs","id":"GJDsK6D9LCFleQDJW-8aL","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/plain":{"content":"<generator object _BaseKFold.split at 0x179e4c7b0>","content_type":"text/plain"}}},"key":"OugsevZSqk"}],"key":"eccDIVascO"}],"key":"i7aOxuwGuv"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":137,"column":1},"end":{"line":142,"column":1}},"children":[{"type":"text","value":"Zwar wurde hiermit die Aufteilung in fünf Teilmengen vollzogen, doch die\neigentlichen Trainings- und Testdaten wurden noch nicht gespeichert und\nweiterverarbeitet. Mithilfe einer for-Schleife greifen wir in jedem Durchgang\nauf die Trainings- und Testindizes zu, die die Methode ","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"key":"e1sMALBFbF"},{"type":"inlineCode","value":"split()","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"key":"X3GVSxJaKK"},{"type":"text","value":" als Tupel\nzurückgibt. Das erste Element enthält die Indizes der Trainingsdaten, das zweite\ndie der Testdaten.","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"key":"tLhavEXzOt"}],"key":"mcBspZb1if"}],"key":"qJ6nJ9QYPG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"for (train_index, test_index) in kfold.split(daten):\n  print(f'Index Trainingsdaten: {train_index}')\n  print(f'Index Testdaten: {test_index}')","key":"aRSeLFfgGM"},{"type":"outputs","id":"5wNTGpDqxmUYbOu4LoB89","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Index Trainingsdaten: [10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33\n 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49]\nIndex Testdaten: [0 1 2 3 4 5 6 7 8 9]\nIndex Trainingsdaten: [ 0  1  2  3  4  5  6  7  8  9 20 21 22 23 24 25 26 27 28 29 30 31 32 33\n 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49]\nIndex Testdaten: [10 11 12 13 14 15 16 17 18 19]\nIndex Trainingsdaten: [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 30 31 32 33\n 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49]\nIndex Testdaten: [20 21 22 23 24 25 26 27 28 29]\nIndex Trainingsdaten: [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23\n 24 25 26 27 28 29 40 41 42 43 44 45 46 47 48 49]\nIndex Testdaten: [30 31 32 33 34 35 36 37 38 39]\nIndex Trainingsdaten: [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23\n 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39]\nIndex Testdaten: [40 41 42 43 44 45 46 47 48 49]\n"},"key":"fWqIrkkDO9"}],"key":"J7b13EpvSX"}],"key":"jaj0JRJIZL"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":150,"column":1},"end":{"line":154,"column":1}},"children":[{"type":"text","value":"Die Aufteilung der Daten erfolgt hierbei sehr systematisch. Im ersten Durchgang\nwerden die Datenpunkte 0–9 als Testdaten verwendet, im zweiten Durchgang die\nPunkte 10–19 und so weiter. Bei sortierten Daten kann dies ungünstig sein. Um\neine zufällige Aufteilung zu gewährleisten, können wir das Argument\n","position":{"start":{"line":150,"column":1},"end":{"line":150,"column":1}},"key":"EqnhsWfp0C"},{"type":"inlineCode","value":"shuffle=True","position":{"start":{"line":150,"column":1},"end":{"line":150,"column":1}},"key":"EuUaP6JyzA"},{"type":"text","value":" verwenden, um die Daten vor dem Split zu mischen.","position":{"start":{"line":150,"column":1},"end":{"line":150,"column":1}},"key":"TZ7JeCoQMp"}],"key":"b6HyZif0k6"}],"key":"m8LyWSWpol"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"kfold = KFold(n_splits = 5, shuffle=True)\n\nfor (train_index, test_index) in kfold.split(daten):\n  print(f'Index Trainingsdaten: {train_index}')\n  print(f'Index Testdaten: {test_index}')","key":"QRZIuPmVyv"},{"type":"outputs","id":"wXjQInt3WV7IGPfK1kuED","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Index Trainingsdaten: [ 0  2  3  4  6  7  8  9 10 12 13 14 15 16 17 18 20 21 22 24 25 28 29 30\n 31 32 33 34 35 36 37 38 39 40 41 42 44 47 48 49]\nIndex Testdaten: [ 1  5 11 19 23 26 27 43 45 46]\nIndex Trainingsdaten: [ 0  1  2  4  5  6  9 10 11 12 13 14 15 16 17 18 19 20 22 23 24 25 26 27\n 28 29 30 32 33 34 37 38 39 40 42 43 44 45 46 49]\nIndex Testdaten: [ 3  7  8 21 31 35 36 41 47 48]\nIndex Trainingsdaten: [ 0  1  2  3  4  5  7  8  9 11 15 16 19 21 22 23 24 25 26 27 28 30 31 32\n 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49]\nIndex Testdaten: [ 6 10 12 13 14 17 18 20 29 33]\nIndex Trainingsdaten: [ 1  2  3  5  6  7  8  9 10 11 12 13 14 15 17 18 19 20 21 23 26 27 28 29\n 30 31 33 34 35 36 38 39 41 42 43 45 46 47 48 49]\nIndex Testdaten: [ 0  4 16 22 24 25 32 37 40 44]\nIndex Trainingsdaten: [ 0  1  3  4  5  6  7  8 10 11 12 13 14 16 17 18 19 20 21 22 23 24 25 26\n 27 29 31 32 33 35 36 37 40 41 43 44 45 46 47 48]\nIndex Testdaten: [ 2  9 15 28 30 34 38 39 42 49]\n"},"key":"zGLpnVgWGX"}],"key":"W9g00UYrs3"}],"key":"U6WC3YPWkd"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":164,"column":1},"end":{"line":167,"column":1}},"children":[{"type":"text","value":"Nun verwenden wir diese fünf Aufteilungen, um einen Entscheidungsbaum zu\ntrainieren. Dabei begrenzen wir die Baumtiefe auf 3 und bewerten in jedem\nDurchgang die Genauigkeit (Score) sowohl auf den Trainings- als auch auf den\nTestdaten.","position":{"start":{"line":164,"column":1},"end":{"line":164,"column":1}},"key":"SrNLwUNM6E"}],"key":"KQIFqJW847"}],"key":"IhIfhOt7kq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from sklearn.tree import DecisionTreeClassifier\n\nmodell = DecisionTreeClassifier(max_depth=3) \nkfold = KFold(n_splits = 5, shuffle=True, random_state=0)\n\nfor (train_index, test_index) in kfold.split(daten):\n  X_train = daten.loc[train_index, ['Merkmal 1', 'Merkmal 2']]\n  y_train = daten.loc[train_index, 'Wirkung']\n  X_test = daten.loc[test_index, ['Merkmal 1', 'Merkmal 2']]\n  y_test = daten.loc[test_index, 'Wirkung']\n  \n  modell.fit(X_train, y_train)\n  score_train = modell.score(X_train, y_train)\n  score_test = modell.score(X_test, y_test)\n\n  print(f'Score Training: {score_train:.2f}, Score Test: {score_test:.2f}')","key":"Orm07htH9t"},{"type":"outputs","id":"NfWEcqCawbQtkov9bQ_JH","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Score Training: 0.85, Score Test: 0.40\nScore Training: 0.85, Score Test: 0.60\nScore Training: 0.85, Score Test: 0.80\nScore Training: 0.90, Score Test: 0.60\nScore Training: 0.85, Score Test: 0.70\n"},"key":"XynZkmqoAj"}],"key":"T3JimR0iV3"}],"key":"fX7FL8z3RC"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":188,"column":1},"end":{"line":194,"column":1}},"children":[{"type":"text","value":"Die Scores auf den Trainingsdaten könnten den Eindruck erwecken, dass der\nEntscheidungsbaum sehr gut funktioniert. Doch die Testdaten zeigen Schwankungen\nzwischen 0.4 und 0.8. Hätten wir eine einfache Aufteilung in Trainings- und\nTestdaten vorgenommen und zufällig den dritten Split erwischt, hätten wir\nwahrscheinlich eine zu optimistische Einschätzung der Modellqualität getroffen.\nAus didaktischen Gründen verwenden wir das Argument ","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"key":"ga15SyakcS"},{"type":"inlineCode","value":"random_state=0","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"key":"TTEq8hG9JK"},{"type":"text","value":", um die\nErgebnisse mit dem Vorlesungsskript vergleichbar zu machen.","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"key":"Mjp6AgEBar"}],"key":"nGod3hGlcs"},{"type":"heading","depth":2,"position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"children":[{"type":"text","value":"Automatische Kreuzvalidierung mit cross_validate","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"key":"fJhUNNCcvs"}],"identifier":"automatische-kreuzvalidierung-mit-cross-validate","label":"Automatische Kreuzvalidierung mit cross_validate","html_id":"automatische-kreuzvalidierung-mit-cross-validate","implicit":true,"key":"ZAmuxP9foy"},{"type":"paragraph","position":{"start":{"line":198,"column":1},"end":{"line":203,"column":1}},"children":[{"type":"text","value":"Wie so oft bietet Scikit-Learn eine elegantere und einfachere Möglichkeit, die\nKreuzvalidierung (Cross Validation) durchzuführen, ohne manuell eine\nfor-Schleife programmieren zu müssen. Die Funktion ","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"ADnuMzdIwc"},{"type":"inlineCode","value":"cross_validate()","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"R3Ryf9SKka"},{"type":"text","value":" übernimmt\ndie Durchführung der Kreuzvalidierung automatisch. Wir importieren sie aus dem\nUntermodul ","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"dV80si0aCv"},{"type":"inlineCode","value":"sklearn.model_selection","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"dYHE668Vdy"},{"type":"text","value":" und teilen anschließend die Daten in\nEingabedaten ","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"bCvZh7o8mS"},{"type":"inlineCode","value":"X","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"BQQ4GqLYS8"},{"type":"text","value":" und Zielgröße ","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"hdQ0koGlhs"},{"type":"inlineCode","value":"y","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"YRvan0fSQM"},{"type":"text","value":" auf.","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"SUpscD8uOW"}],"key":"r70ZgzxYDW"},{"type":"paragraph","position":{"start":{"line":205,"column":1},"end":{"line":212,"column":1}},"children":[{"type":"text","value":"Die Funktion ","position":{"start":{"line":205,"column":1},"end":{"line":205,"column":1}},"key":"W0cPCMtB6i"},{"type":"inlineCode","value":"cross_validate()","position":{"start":{"line":205,"column":1},"end":{"line":205,"column":1}},"key":"Qh5YfPW193"},{"type":"text","value":" wird mit dem ML-Modell (hier einem\nEntscheidungsbaum), den Eingabedaten ","position":{"start":{"line":205,"column":1},"end":{"line":205,"column":1}},"key":"Cxkl0xJxNY"},{"type":"inlineCode","value":"X","position":{"start":{"line":205,"column":1},"end":{"line":205,"column":1}},"key":"lcMfUUAiUH"},{"type":"text","value":" und der Zielgröße ","position":{"start":{"line":205,"column":1},"end":{"line":205,"column":1}},"key":"CjWQfR9wrU"},{"type":"inlineCode","value":"y","position":{"start":{"line":205,"column":1},"end":{"line":205,"column":1}},"key":"MFGiofoRwI"},{"type":"text","value":" aufgerufen.\nStandardmäßig wird eine 5-fache Kreuzvalidierung ohne Mischen durchgeführt. Mit\ndem optionalen Argument ","position":{"start":{"line":205,"column":1},"end":{"line":205,"column":1}},"key":"tc0eZXRu3h"},{"type":"inlineCode","value":"cv=","position":{"start":{"line":205,"column":1},"end":{"line":205,"column":1}},"key":"NFMQGJ1Md8"},{"type":"text","value":" kann jedoch auch ein benutzerdefinierter\nAufteilungsgenerator übergeben werden, wie zum Beispiel ","position":{"start":{"line":205,"column":1},"end":{"line":205,"column":1}},"key":"bLFNlxeEjy"},{"type":"inlineCode","value":"KFold","position":{"start":{"line":205,"column":1},"end":{"line":205,"column":1}},"key":"oa3qVIgzBr"},{"type":"text","value":". Das zusätzliche\nArgument ","position":{"start":{"line":205,"column":1},"end":{"line":205,"column":1}},"key":"cEXSrieh9O"},{"type":"inlineCode","value":"return_train_score=True","position":{"start":{"line":205,"column":1},"end":{"line":205,"column":1}},"key":"SwsJ19hufO"},{"type":"text","value":" sorgt dafür, dass auch die Trainingsscores in\njedem Durchlauf gespeichert werden. Der entsprechende Code sieht folgendermaßen\naus:","position":{"start":{"line":205,"column":1},"end":{"line":205,"column":1}},"key":"xr7zpRYKCS"}],"key":"H0412IZKaT"}],"key":"kwfegqftQh"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from sklearn.model_selection import cross_validate\n\nX = daten[['Merkmal 1', 'Merkmal 2']]\ny = daten['Wirkung']\n\ncv_results = cross_validate(modell, X,y, cv=kfold, return_train_score=True)","key":"jnA0UCZSmn"},{"type":"outputs","id":"Mp2idFtoyriDoiakypnp8","children":[],"key":"irwT7Sp1Mv"}],"key":"kj3GkNYdMx"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":223,"column":1},"end":{"line":224,"column":1}},"children":[{"type":"text","value":"Die Funktion ","position":{"start":{"line":223,"column":1},"end":{"line":223,"column":1}},"key":"BqLEl0Z5C2"},{"type":"inlineCode","value":"cross_validate()","position":{"start":{"line":223,"column":1},"end":{"line":223,"column":1}},"key":"eKiNvtst0p"},{"type":"text","value":" gibt ein Dictionary zurück, das wie folgt\naufgebaut ist:","position":{"start":{"line":223,"column":1},"end":{"line":223,"column":1}},"key":"qNhWYdBO5N"}],"key":"Pt0WfjHa24"}],"key":"PcYLM57A7R"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(cv_results)","key":"FcdZYu9WAX"},{"type":"outputs","id":"0298zGm4fNE5Xc0RX1AZE","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"{'fit_time': array([0.00226688, 0.00181103, 0.00191021, 0.00162578, 0.0007391 ]), 'score_time': array([0.00158787, 0.00178504, 0.00151873, 0.00106716, 0.00053477]), 'test_score': array([0.4, 0.6, 0.8, 0.6, 0.7]), 'train_score': array([0.85, 0.85, 0.85, 0.9 , 0.85])}\n"},"key":"Fise5ptNWD"}],"key":"jhrwchikID"}],"key":"KWDAiJ4Uwq"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":230,"column":1},"end":{"line":235,"column":1}},"children":[{"type":"text","value":"In diesem Dictionary sind zunächst die Rechenzeiten für das Training\n(","position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"key":"jfM5Sdpdx4"},{"type":"inlineCode","value":"'fit_time'","position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"key":"mD6EXuuZCc"},{"type":"text","value":") und die Prognose (","position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"key":"nLNzidp1Z2"},{"type":"inlineCode","value":"'score_time'","position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"key":"LvfHrgvzVd"},{"type":"text","value":") gespeichert. Danach folgen die\nScores der Testdaten (","position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"key":"cL4fAioePA"},{"type":"inlineCode","value":"'test_score'","position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"key":"PAXDP0ItBR"},{"type":"text","value":"). Falls das Argument\n","position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"key":"KZxsONhIQ9"},{"type":"inlineCode","value":"return_train_score=True","position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"key":"cinw4VBIOv"},{"type":"text","value":" gesetzt wurde, enthält das Dictionary auch die Scores\nder Trainingsdaten (","position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"key":"YFCPSspkFE"},{"type":"inlineCode","value":"'train_score'","position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"key":"ydjyiMMXzY"},{"type":"text","value":"). Die Scores können wir wie folgt anzeigen\nlassen:","position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"key":"pqi92Pk2To"}],"key":"bbwUD3gMQL"}],"key":"we09MQ24Ds"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(cv_results['test_score'])\nprint(cv_results['train_score'])","key":"V4KU7pOycx"},{"type":"outputs","id":"2fl9Pm6nv1J7zcCMUDRPC","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"[0.4 0.6 0.8 0.6 0.7]\n[0.85 0.85 0.85 0.9  0.85]\n"},"key":"iAVHLaZWgd"}],"key":"B2PKq3jSda"}],"key":"y5cGeVVltN"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":242,"column":1},"end":{"line":244,"column":1}},"children":[{"type":"text","value":"Weitere Details zu der Funktion ","position":{"start":{"line":242,"column":1},"end":{"line":242,"column":1}},"key":"xRoxfYXEdX"},{"type":"inlineCode","value":"cross_validate()","position":{"start":{"line":242,"column":1},"end":{"line":242,"column":1}},"key":"vJg9LZSnlD"},{"type":"text","value":" finden Sie in der\n","position":{"start":{"line":242,"column":1},"end":{"line":242,"column":1}},"key":"A7zxNxL1sd"},{"type":"link","url":"https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.cross_validate.html","position":{"start":{"line":242,"column":1},"end":{"line":242,"column":1}},"children":[{"type":"text","value":"Dokumentation Scikit-Learn →\ncross_validate","position":{"start":{"line":242,"column":1},"end":{"line":242,"column":1}},"key":"t6h7w3Sfof"}],"urlSource":"https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.cross_validate.html","key":"FoxS9Hfo1i"},{"type":"text","value":".","position":{"start":{"line":242,"column":1},"end":{"line":242,"column":1}},"key":"d4gfvaXGSp"}],"key":"o1PdFfFJIx"},{"type":"heading","depth":2,"position":{"start":{"line":246,"column":1},"end":{"line":246,"column":1}},"children":[{"type":"text","value":"Zusammenfassung und Ausblick","position":{"start":{"line":246,"column":1},"end":{"line":246,"column":1}},"key":"fEgswxZLFI"}],"identifier":"zusammenfassung-und-ausblick","label":"Zusammenfassung und Ausblick","html_id":"zusammenfassung-und-ausblick","implicit":true,"key":"vcMDszj3Un"},{"type":"paragraph","position":{"start":{"line":248,"column":1},"end":{"line":252,"column":1}},"children":[{"type":"text","value":"Die Kreuzvalidierung ist ein wichtiges Werkzeug, insbesondere wenn es um die\nFeinjustierung der Hyperparameter geht, also das sogenannte\nHyperparameter-Tuning. Im nächsten Kapitel werden wir uns mit der Kombination\nvon Kreuzvalidierung (Cross Validation) und einer Gittersuche (Grid Search)\nbeschäftigen, um die optimalen Hyperparameter für ein Modell zu finden.","position":{"start":{"line":248,"column":1},"end":{"line":248,"column":1}},"key":"tmcRSe61fE"}],"key":"vwKYCXc9VP"}],"key":"CCkgIKw7Ku"}],"key":"pClYyQbKEr"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Übung","url":"/chapter10-sec04","group":"10. Support Vector Machines"},"next":{"title":"11.2 Gittersuche","url":"/chapter11-sec02","group":"11. ML-Workflow Modellbewertung und Auswahl"}}},"domain":"http://localhost:3004"}