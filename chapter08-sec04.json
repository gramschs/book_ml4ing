{"version":3,"kind":"Notebook","sha256":"a3ad1d0eaf04a30808a0921eec9b66c874a019f10b27918171a05d4209a3837e","slug":"chapter08-sec04","location":"/chapter08/chapter08_sec04.md","dependencies":[],"frontmatter":{"title":"Übungen","kernelspec":{"name":"python3","display_name":"Python 3","language":"python"},"jupytext":{"formats":"ipynb,md:myst","text_representation":{"extension":".md","format_name":"myst","format_version":"0.13","jupytext_version":"1.15.2"}},"content_includes_title":false,"authors":[{"id":"Simone Gramsch","name":"Simone Gramsch"}],"open_access":true,"license":{"content":{"id":"CC-BY-NC-SA-4.0","url":"https://creativecommons.org/licenses/by-nc-sa/4.0/","name":"Creative Commons Attribution Non Commercial Share Alike 4.0 International","CC":true}},"github":"https://github.com/gramschs/book_ml4ing","numbering":{"title":{"offset":1}},"source_url":"https://github.com/gramschs/book_ml4ing/blob/main/chapter08/chapter08_sec04.md","edit_url":"https://github.com/gramschs/book_ml4ing/edit/main/chapter08/chapter08_sec04.md","exports":[{"format":"md","filename":"chapter08_sec04.md","url":"/book_ml4ing/build/chapter08_sec04-08211a338ffba35dbc7a29418468cb9e.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Aufgabe 1","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"A7hR2tG3GB"}],"key":"mzZlrWQsIg"},{"type":"paragraph","position":{"start":{"line":19,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"Eine Abalone oder ein Seeohr ist eine Schnecke mit Schale, die einer Ohrmuschel\nähnelt (siehe ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"p78f01P7CW"},{"type":"link","url":"https://de.wikipedia.org/wiki/Seeohren","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Seeohren","key":"U7oqC2sG2L"}],"urlSource":"https://de.wikipedia.org/wiki/Seeohren","data":{"page":"Seeohren","wiki":"https://de.wikipedia.org/","lang":"de"},"internal":false,"protocol":"wiki","key":"RGiP5Io2F2"},{"type":"text","value":"). Laden Sie den Datensatz\n‘abalone_DE.csv’. Ziel dieser Aufgabe ist ein Modell zu trainieren, das aus den\nAngaben zu Geschlecht, Größe und Gewicht die Anzahl der Ringe prognostiziert.\nDie Anzahl der Ringe +1.5 gibt das Alter der Abalone an.","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"Xe8PKu7oLS"}],"key":"g7VztQHh9q"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":25,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":25,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Führen Sie eine Datenexploration durch. Dazu gehören insbesondere","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"d3TRszcly1"}],"key":"DZc3PjaIpx"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":26,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Übersicht","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"DKfyIefUkh"}],"key":"JiQAklCFq8"}],"key":"c0EF4qFdN1"},{"type":"listItem","spread":true,"position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"statistische Kennzahlen der Eigenschaften","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"lqQBTahO35"}],"key":"RxynmIpSg2"}],"key":"yPXoGuv0nD"},{"type":"listItem","spread":true,"position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Visualisierungen der Eigenschaften","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"BLaK5YZZEm"}],"key":"cgdkFIRXcT"}],"key":"t9jQ8okjUu"},{"type":"listItem","spread":true,"position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Analyse bzgl. Ausreißer","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"PVHXbRpOTt"}],"key":"RUGFDtZIpa"}],"key":"ytRpVWBbZo"}],"key":"QCI8iaxD6N"}],"key":"SKrurj3JVX"},{"type":"listItem","spread":true,"position":{"start":{"line":30,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Bereinigen Sie den Datensatz. Dazu gehört insbesondere die Entfernung von\nAusreißern.","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"jPDgvumbE9"}],"key":"TJufmhb8Dt"}],"key":"V5PtD3Qaeq"},{"type":"listItem","spread":true,"position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Wählen Sie ein Modell.","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"rxG288a5v2"}],"key":"TLIbM7xKXO"}],"key":"BYLXKBNBNC"},{"type":"listItem","spread":true,"position":{"start":{"line":33,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Bereiten Sie die Daten für das Modell auf. Dazu gehört insbesondere auch der\nSplit in Trainings- und Testdaten.","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"mF4LJxV4Ec"}],"key":"qTOrcG4SY7"}],"key":"TGxNP89tDS"},{"type":"listItem","spread":true,"position":{"start":{"line":35,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Validieren Sie das Modell. Erhöhen Sie die Modellkomplexität und beurteilen\nSie, ob Over- oder Underfitting vorliegt.","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"pA1XxtK03P"}],"key":"nB6AojH2gO"}],"key":"Cf4lVb0HCV"},{"type":"listItem","spread":true,"position":{"start":{"line":37,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Kodieren Sie das Geschlecht mit One-Hot-Kodierung und trainieren Sie das\nModell erneut. Verbessert sich die Prognose?","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"TpijR8SUaC"}],"key":"zDXgOPgQcF"}],"key":"aoYOXJaZkz"}],"key":"mHbkNCjuOG"}],"class":"tip","key":"y4kOmiMfat"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Lösung","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"key":"T4xdx41W7E"}],"key":"gWPsiDdbDP"},{"type":"code","lang":"python","value":"import pandas as pd\n\ndata = pd.read_csv('abalone_DE.csv', skiprows=3)","position":{"start":{"line":45,"column":1},"end":{"line":49,"column":1}},"key":"qdnZqSarFm"},{"type":"code","lang":"python","value":"data.head(10)","position":{"start":{"line":51,"column":1},"end":{"line":53,"column":1}},"key":"LOn9bSb16D"},{"type":"paragraph","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"children":[{"type":"text","value":"Abalone oder Seeohr: ","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"rfvZNIQurw"},{"type":"link","url":"https://de.wikipedia.org/wiki/Seeohren","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"children":[{"type":"text","value":"Seeohren","key":"bQ6RVHAqJ2"}],"urlSource":"https://de.wikipedia.org/wiki/Seeohren","data":{"page":"Seeohren","wiki":"https://de.wikipedia.org/","lang":"de"},"internal":false,"protocol":"wiki","key":"I6yEzwYgU1"}],"key":"CYTZ6mTkKZ"},{"type":"paragraph","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"children":[{"type":"text","value":"Der Abalone-Datensatz enthält folgende Variablen:","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"Nq6V3r9s7g"}],"key":"lboCy1LZIB"},{"type":"paragraph","position":{"start":{"line":59,"column":1},"end":{"line":67,"column":1}},"children":[{"type":"text","value":"Sex → Geschlecht\nLength → Länge (in Millimetern)\nDiameter → Durchmesser (senkrecht zur Länge, in Millimetern)\nHeight → Höhe (mit Fleisch in der Schale, in Millimetern)\nWhole weight → Gesamtgewicht (in Gramm)\nShucked weight → Gewicht geschält (Gewicht Fleisch, in Gramm)\nViscera weight → Gewicht der Eingeweide (in Gramm)\nShell weight → Gewicht der Schale (nach dem Trocknen, in Gramm)\nRings → Ringe (+ 1.5 ergibt das Alter der Abalone)","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"FOHJrJjd9q"}],"key":"rOFEvqFf7H"},{"type":"code","lang":"python","value":"data.info()","position":{"start":{"line":69,"column":1},"end":{"line":71,"column":1}},"key":"SlkXazcCKN"},{"type":"paragraph","position":{"start":{"line":73,"column":1},"end":{"line":78,"column":1}},"children":[{"type":"text","value":"Der Abalone-Datensatz enthält 4177 gültige Einträge mit 9 Eigenschaften. Der\nDatentyp des Geschlechts ist Object. Die physikalischen Eigenschaften der\nAbalonen Größe (Länge, Durchmesser und Höhe) und Gewicht (Gesamtgewicht, Gewicht\ngeschält, Gewicht der Eingeweide, Gewicht der Schale) sind als Floats gegeben.\nDie Anzahl der Ringe wird durch einen Integer repräsentiert. Alle Einträge sind\ngültig.","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"key":"UDYSulEcTV"}],"key":"rKYemU0ZLB"},{"type":"paragraph","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"children":[{"type":"text","value":"Wir untersuchen nacheinander Geschlecht, Größe, Gewicht und Ringe.","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"key":"GgiJJLL3Wg"}],"key":"Cc2WBAl6VU"},{"type":"code","lang":"python","value":"data['Geschlecht'].describe()","position":{"start":{"line":82,"column":1},"end":{"line":84,"column":1}},"key":"jzMvEa7B3D"},{"type":"code","lang":"python","value":"data['Geschlecht'].value_counts()","position":{"start":{"line":86,"column":1},"end":{"line":88,"column":1}},"key":"Jul5vsCm5K"},{"type":"paragraph","position":{"start":{"line":90,"column":1},"end":{"line":92,"column":1}},"children":[{"type":"text","value":"Das Geschlecht enthält drei einzigartige Werte: männlich, Jungtier und weiblich.\nEs sind etwas mehr männliche Abalonen im Datensatz enthalten, Jungtiere und\nweibliche Abalonen gibt es ungefähr gleich viele.","position":{"start":{"line":90,"column":1},"end":{"line":90,"column":1}},"key":"LaRlIXr1aP"}],"key":"V5vemRpCVU"},{"type":"code","lang":"python","value":"import plotly.express as px\n\nfig = px.bar(data['Geschlecht'],\n             title='Anzahl der Abalonen nach Geschlecht',\n             labels={'value': '', 'count': 'Anzahl', 'variable': 'Legende'})\nfig.show()","position":{"start":{"line":94,"column":1},"end":{"line":101,"column":1}},"key":"GKDcuz5B44"},{"type":"paragraph","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"children":[{"type":"text","value":"Als nächstes betrachten wir die Größe der Abalonen.","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"key":"zLRMDuxLU2"}],"key":"mtxV2w2yWo"},{"type":"code","lang":"python","value":"data[['Länge [mm]', 'Durchmesser [mm]', 'Höhe [mm]']].describe()","position":{"start":{"line":105,"column":1},"end":{"line":107,"column":1}},"key":"SrGNsdEOqJ"},{"type":"code","lang":"python","value":"fig = px.box(data[['Länge [mm]', 'Durchmesser [mm]', 'Höhe [mm]']],\n             title='Größe der Abalonen',\n             labels={'variable': '', 'value': 'Größenangabe in mm'})\nfig.show()","position":{"start":{"line":109,"column":1},"end":{"line":114,"column":1}},"key":"PdwnEki5zD"},{"type":"paragraph","position":{"start":{"line":116,"column":1},"end":{"line":119,"column":1}},"children":[{"type":"text","value":"Bei allen drei Größenangaben gibt es Ausreißer nach unten. Auffällig sind jedoch\ndie beiden Ausreißer bei der Höhe. Die mittlere Höhe sind 0.139516 mm, der\nMedian liegt bei 0.14 mm. Die beiden Ausreißer haben mit 0.515 mm und 1.13 mm\nmehr als die zehnfache Höhe. Um welche Abalonen handelt es sich?","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"key":"JAZktUbWUV"}],"key":"CaI8oqbBN2"},{"type":"code","lang":"python","value":"data[ data['Höhe [mm]'] > 0.5 ].head(2)","position":{"start":{"line":121,"column":1},"end":{"line":123,"column":1}},"key":"OKVVIK9XCs"},{"type":"paragraph","position":{"start":{"line":125,"column":1},"end":{"line":127,"column":1}},"children":[{"type":"text","value":"Abalone 1417 scheint einfach nur groß zu sein, bei Abalone 2051 passt die Höhe\naber nicht zu den ansonsten eher durchschnittlichen Größenangaben. Im Folgenden\neliminieren wir die beiden Ausreißer aus dem Datensatz.","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"key":"zDc0IMB19H"}],"key":"k3wPWgIXlI"},{"type":"code","lang":"python","value":"data = data[ data['Höhe [mm]'] <= 0.5 ]\ndata.info()","position":{"start":{"line":129,"column":1},"end":{"line":132,"column":1}},"key":"OPjqZPEO1d"},{"type":"code","lang":"python","value":"data[['Länge [mm]', 'Durchmesser [mm]', 'Höhe [mm]']].describe()","position":{"start":{"line":134,"column":1},"end":{"line":136,"column":1}},"key":"IE9TZ9OolA"},{"type":"code","lang":"python","value":"fig = px.box(data[['Länge [mm]', 'Durchmesser [mm]', 'Höhe [mm]']],\n             title='Größe der Abalonen',\n             labels={'variable': '', 'value': 'Größenangabe in mm'})\nfig.show()","position":{"start":{"line":138,"column":1},"end":{"line":143,"column":1}},"key":"AlqHBpf7H4"},{"type":"paragraph","position":{"start":{"line":145,"column":1},"end":{"line":145,"column":1}},"children":[{"type":"text","value":"Als nächstes betrachten wir die Gewichtsangaben.","position":{"start":{"line":145,"column":1},"end":{"line":145,"column":1}},"key":"Nw9my1qsiP"}],"key":"NFnoOUejhQ"},{"type":"code","lang":"python","value":"data[['Gesamtgewicht [g]', 'Gewicht geschält [g]', 'Gewicht der Eingeweide [g]', 'Gewicht der Schale [g]']].describe()","position":{"start":{"line":147,"column":1},"end":{"line":149,"column":1}},"key":"ArlAoCPXNx"},{"type":"code","lang":"python","value":"fig = px.box(data[['Gesamtgewicht [g]', 'Gewicht geschält [g]', 'Gewicht der Eingeweide [g]', 'Gewicht der Schale [g]']],\n             title='Gewicht der Abalonen',\n             labels={'variable': '', 'value': 'Gewicht in g'})\nfig.show()","position":{"start":{"line":151,"column":1},"end":{"line":156,"column":1}},"key":"yEGdUBSWeG"},{"type":"paragraph","position":{"start":{"line":158,"column":1},"end":{"line":159,"column":1}},"children":[{"type":"text","value":"Bei den Gewichtsangaben gibt es einige Ausreißer nach oben, aber keine\noffensichtlich herausragenden Ausreißer.","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"key":"aVeaL8C5xb"}],"key":"sxbx57md5B"},{"type":"paragraph","position":{"start":{"line":161,"column":1},"end":{"line":162,"column":1}},"children":[{"type":"text","value":"Zuletzt verschaffen wir uns noch einen Überblick über die statistischen\nKennzahlen der Ringe.","position":{"start":{"line":161,"column":1},"end":{"line":161,"column":1}},"key":"zv0MTn3oCL"}],"key":"LpohcsjFeS"},{"type":"code","lang":"python","value":"data['Ringe'].describe()","position":{"start":{"line":164,"column":1},"end":{"line":166,"column":1}},"key":"DzaXFzgbb1"},{"type":"code","lang":"python","value":"fig = px.box(data['Ringe'],\n             title='Ringe der Abalonen',\n             labels={'variable': '', 'value': 'Anzahl'})\nfig.show()","position":{"start":{"line":168,"column":1},"end":{"line":173,"column":1}},"key":"p8QcGcqRVq"},{"type":"code","lang":"python","value":"fig = px.bar(data['Ringe'].value_counts())\nfig.show()","position":{"start":{"line":175,"column":1},"end":{"line":178,"column":1}},"key":"Mg71tPJoqI"},{"type":"paragraph","position":{"start":{"line":180,"column":1},"end":{"line":181,"column":1}},"children":[{"type":"text","value":"Mittelwert 9.9 und Median 9 stimmen praktisch überein. Das Histogramm der Ringe\nzeigt aber auch eine ganz leichte Rechtsschiefe.","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"key":"xwfvc64CUG"}],"key":"Z7emZMgxNh"},{"type":"paragraph","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"children":[{"type":"text","value":"Als nächstes untersuchen wir, welche Wirkung Größe und Gewicht auf die Ringe haben.","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"key":"OO30klcQnb"}],"key":"QZEZeZANRP"},{"type":"code","lang":"python","value":"fig = px.scatter_matrix(data[['Länge [mm]', 'Durchmesser [mm]', 'Höhe [mm]', 'Ringe']])\nfig.show()","position":{"start":{"line":185,"column":1},"end":{"line":188,"column":1}},"key":"EXskl4O1qX"},{"type":"paragraph","position":{"start":{"line":190,"column":1},"end":{"line":190,"column":1}},"children":[{"type":"text","value":"Je größer eine Abalone ist, desto mehr Ringe scheint sie zu haben.","position":{"start":{"line":190,"column":1},"end":{"line":190,"column":1}},"key":"uy5hAZGEtv"}],"key":"xtlmdaIVLC"},{"type":"code","lang":"python","value":"fig = px.scatter_matrix(data[['Gesamtgewicht [g]', 'Gewicht geschält [g]', 'Gewicht der Eingeweide [g]', 'Gewicht der Schale [g]', 'Ringe']])\nfig.show()","position":{"start":{"line":192,"column":1},"end":{"line":195,"column":1}},"key":"qnoT5ifJoO"},{"type":"paragraph","position":{"start":{"line":197,"column":1},"end":{"line":197,"column":1}},"children":[{"type":"text","value":"Auch bei steigenden Gewicht scheint die Anzahl der Ringe zuzunehmen.","position":{"start":{"line":197,"column":1},"end":{"line":197,"column":1}},"key":"pPkmAkhgtx"}],"key":"ZKX9Ps6SCl"},{"type":"paragraph","position":{"start":{"line":199,"column":1},"end":{"line":199,"column":1}},"children":[{"type":"text","value":"Zuletzt trainieren wir ein multiples lineares Regressionsmodell.","position":{"start":{"line":199,"column":1},"end":{"line":199,"column":1}},"key":"OYsZZZlI9o"}],"key":"GGVeIDVaWh"},{"type":"code","lang":"python","value":"from sklearn.linear_model import LinearRegression\nfrom sklearn.model_selection import train_test_split\n\n# Split der Daten in Trainingsdaten und Testdaten\ndata_train, data_test = train_test_split(data, random_state=42)\n\n# Wahl des linearen Regressionsmodells\nmodel = LinearRegression()\n\n# Adaption der Daten für das lineare Regressionsmodell\n# Geschlecht wird weggelassen, da kategorial\nX_train = data_train.loc[:, 'Länge [mm]' : 'Gewicht der Schale [g]']\ny_train = data_train['Ringe']\n\n# Training\nmodel.fit(X_train, y_train)\n\n# Validierung\nr2_score_train = model.score(X_train, y_train)\n\nX_test = data_test.loc[:, 'Länge [mm]' : 'Gewicht der Schale [g]']\ny_test = data_test['Ringe']\n\nr2_score_test = model.score(X_test, y_test)\n\nprint(f'R2-Score Trainingsdaten: {r2_score_train:.2f}')\nprint(f'R2-Score Testdaten: {r2_score_test:.2f}')","position":{"start":{"line":201,"column":1},"end":{"line":229,"column":1}},"key":"wtKxnEry89"},{"type":"paragraph","position":{"start":{"line":231,"column":1},"end":{"line":236,"column":1}},"children":[{"type":"text","value":"Bei den Trainingsdaten und bei den Testdaten erzielen wir R²-Scores von ca. 0.55\n(leicht variierend je nach zufälliger Aufteilung in Test- und Trainingsdaten).\nDamit scheint die gewählte Modellkomplexität für die Daten zu gering zu sein.\nWir erhöhen die Modellkomplexität, gehen also zu einer polynomialen Regression\nüber. Zu jedem Polynomgrad betrachten wir den jeweiligen R²-Score für\nTrainingsdaten und Testdaten.","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":1}},"key":"nAeTZozsxu"}],"key":"bHZ5SQ0uAC"},{"type":"code","lang":"python","value":"from sklearn.preprocessing import PolynomialFeatures\n\nfor d in [2, 3, 4, 5]:\n    polynom_transformator = PolynomialFeatures(degree = d)\n\n    # Adaption der Daten für das lineare Regressionsmodell\n    X_train = polynom_transformator.fit_transform(data_train.loc[:, 'Länge [mm]' : 'Gewicht der Schale [g]'])\n    y_train = data_train['Ringe']\n\n    # Training\n    model.fit(X_train, y_train)\n\n    # Validierung\n    r2_score_train = model.score(X_train, y_train)\n\n    X_test = polynom_transformator.transform(data_test.loc[:, 'Länge [mm]' : 'Gewicht der Schale [g]'])\n    y_test = data_test['Ringe']\n\n    r2_score_test = model.score(X_test, y_test)\n\n    print(f'Grad: {d} ==> R2-Score Trainingsdaten: {r2_score_train:.2f} | R2-Score Testdaten: {r2_score_test:.2f}')","position":{"start":{"line":238,"column":1},"end":{"line":260,"column":1}},"key":"FJukgBEWcO"},{"type":"paragraph","position":{"start":{"line":262,"column":1},"end":{"line":269,"column":1}},"children":[{"type":"text","value":"Der Wechsel von einem linearen auf ein quadratisches Regressionspolynom scheint\neine leichte Verbesserung des R2-Wertes zu bringen. Aber bereits bei Grad 3\nfällt der R²-Score bei den Testdaten auf 0.25 ab, während er für die\nTrainingsdaten auf 0.61 steigt. Damit befinden wir uns bereits im Overfitting. Bei\nGrad 4 und 5 sind die R²-Scores sogar negativ. Daher darf allerhöchstens Grad 2\nfür das Regressionspolynom gewählt werden. Da aber die Verbesserung von Grad 1\nauf 2 nur marginal ist, ist weiterhin das lineare multiple Regressionsmodell\nempfehlenswert.","position":{"start":{"line":262,"column":1},"end":{"line":262,"column":1}},"key":"umwJekkocq"}],"key":"fK6KzzfyWx"},{"type":"paragraph","position":{"start":{"line":271,"column":1},"end":{"line":273,"column":1}},"children":[{"type":"text","value":"Nun beziehen wir noch das Geschlecht ein. Dazu kodieren wir es mit\nOne-Hot-Kodierung und trainieren dann das lineare multiple Regressionsmodell\nerneut.","position":{"start":{"line":271,"column":1},"end":{"line":271,"column":1}},"key":"PiAYzGdCcr"}],"key":"OSU3e3yEnw"},{"type":"code","lang":"python","value":"# One-Hot-Kodierung des Geschlechts\ndata_kodiert = pd.get_dummies(data, columns=['Geschlecht'])\n\n # Erneuter Split (mit gleichem random_state für Vergleichbarkeit)\ndata_train, data_test = train_test_split(data_kodiert, random_state=42)\n\n# Training mit Geschlecht\nX_train = data_train.drop(columns=['Ringe'])\ny_train = data_train['Ringe']\nmodel.fit(X_train, y_train)\n\n# Validierung\nX_test = data_test.drop(columns=['Ringe'])\ny_test = data_test['Ringe']\nr2_score_test = model.score(X_test, y_test)\nprint(f'R2-Score mit Geschlecht: {r2_score_test:.2f}')","position":{"start":{"line":275,"column":1},"end":{"line":292,"column":1}},"key":"B6WD8RVFBT"},{"type":"paragraph","position":{"start":{"line":294,"column":1},"end":{"line":296,"column":1}},"children":[{"type":"text","value":"Der R²-Score ist bei den Testdaten minimal von 0.56 auf 0.57 gestiegen. Eine\nsignifikante Verbesserung des Modells ist es nicht, das Geschlecht mit\nhinzuzunehmen.","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"key":"IN9ILZ589v"}],"key":"iZYEdEzthH"}],"class":"tip dropdown","key":"TDEDfPhZbR"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Aufgabe 2","position":{"start":{"line":299,"column":1},"end":{"line":299,"column":1}},"key":"m2gOYqnORL"}],"key":"RGAksrjmqX"},{"type":"paragraph","position":{"start":{"line":301,"column":1},"end":{"line":305,"column":1}},"children":[{"type":"text","value":"Der Datensatz\n‘statistic_id226994_annual-average-unemployment-figures-for-germany-2005-2022.csv’\nstammt von Statista. Die Daten beschreiben die Entwicklung der\nArbeitslosenzahlen (in Mio.) seit 1991. Im Original-Excel sind einige\nUngereimtheiten, die sich auch so im csv-File befinden.","position":{"start":{"line":301,"column":1},"end":{"line":301,"column":1}},"key":"mlUjU5Llv8"}],"key":"A2cJAoneuJ"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":307,"column":1},"end":{"line":315,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":307,"column":1},"end":{"line":307,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Korrigieren Sie den Datensatz zuerst mit einem Texteditor.","position":{"start":{"line":307,"column":1},"end":{"line":307,"column":1}},"key":"SjlZIuqTgt"}],"key":"osj5DVKApA"}],"key":"U9GsgFL2jR"},{"type":"listItem","spread":true,"position":{"start":{"line":308,"column":1},"end":{"line":310,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Führen Sie dann eine explorative Datenanalyse durch (Übersicht, statistische\nKennzahlen, Boxplot und Visualisierung der Arbeitslosenzahlen abhängig vom\nJahr.)","position":{"start":{"line":308,"column":1},"end":{"line":308,"column":1}},"key":"GOzOELNW31"}],"key":"LwFzQCa3Q4"}],"key":"gADlIrEB5O"},{"type":"listItem","spread":true,"position":{"start":{"line":311,"column":1},"end":{"line":312,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Wählen Sie mehrere ML-Modelle aus. Adaptieren Sie die Daten für das Training\nund lassen Sie die gewählten ML-Modelle trainieren.","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"key":"Qxa0tHRXp5"}],"key":"a8mSXJ3JQu"}],"key":"ExtgFpc5Yo"},{"type":"listItem","spread":true,"position":{"start":{"line":313,"column":1},"end":{"line":314,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Validieren Sie Ihr Modell: ist es geeignet? Bewerten Sie die Modelle bzgl.\nOver- und Underfitting.","position":{"start":{"line":313,"column":1},"end":{"line":313,"column":1}},"key":"YIlyAy9OJC"}],"key":"fplXDgvZWH"}],"key":"p18s3N5s82"},{"type":"listItem","spread":true,"position":{"start":{"line":315,"column":1},"end":{"line":315,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Visualisieren Sie eine Prognose von 1990 bis 2030.","position":{"start":{"line":315,"column":1},"end":{"line":315,"column":1}},"key":"Jt4sBcNFNx"}],"key":"piMpXmdlza"}],"key":"yEECLzF2nD"}],"key":"AjCrl4ZtI6"}],"class":"tip","key":"l5YtzQ14jR"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Lösung","position":{"start":{"line":318,"column":1},"end":{"line":318,"column":1}},"key":"P0bO0VRFis"}],"key":"CKQiD6r33X"},{"type":"code","lang":"python","value":"import pandas as pd\n\ndata = pd.read_csv('statistic_id226994_korrigiert.csv')\ndata.info()","position":{"start":{"line":322,"column":1},"end":{"line":327,"column":1}},"key":"meYhy5z350"},{"type":"paragraph","position":{"start":{"line":329,"column":1},"end":{"line":329,"column":1}},"children":[{"type":"text","value":"Der Datensatz enthält 32 Zeilen und zwei Spalten. Das Jahr wird durch Integer repräsentiert, die Arbeitslosenzahl durch Floats.","position":{"start":{"line":329,"column":1},"end":{"line":329,"column":1}},"key":"S4IksvdMQI"}],"key":"C6CO2exx75"},{"type":"code","lang":"python","value":"einzigartige_jahre = len(data['Jahr'].unique())\nprint(f'Es sind {einzigartige_jahre} verschiedene Jahreszahlen gelistet.')","position":{"start":{"line":331,"column":1},"end":{"line":334,"column":1}},"key":"kGKjadBMYi"},{"type":"paragraph","position":{"start":{"line":336,"column":1},"end":{"line":336,"column":1}},"children":[{"type":"text","value":"Die Arbeitslosenzahlen sind Floats und alle Einträge sind gültig.","position":{"start":{"line":336,"column":1},"end":{"line":336,"column":1}},"key":"a6YVR84gQx"}],"key":"q3gXwwIQ1A"},{"type":"code","lang":"python","value":"data.describe()","position":{"start":{"line":338,"column":1},"end":{"line":340,"column":1}},"key":"W0cRj98LPL"},{"type":"code","lang":"python","value":"import plotly.express as px\n\nfig = px.box(data['Arbeitslosenzahl'],\n             title='Arbeitslosenzahlen in Deutschland von 1991 bis 2022',\n             labels={'variable':'', 'value': 'Mio. Personen'})\nfig.show()","position":{"start":{"line":342,"column":1},"end":{"line":349,"column":1}},"key":"eZFX9m4ns1"},{"type":"paragraph","position":{"start":{"line":351,"column":1},"end":{"line":352,"column":1}},"children":[{"type":"text","value":"Der Median liegt mittig zwischen Q1 und Q3, aber insgesamt gibt es mehrere\nJahre, bei denen mehr als 4 Mio. Arbeitslose (Q3) gibt. Es gibt keine Ausreißer.","position":{"start":{"line":351,"column":1},"end":{"line":351,"column":1}},"key":"VMwvFLPZaq"}],"key":"Ju84cSH4Cd"},{"type":"blockBreak","position":{"start":{"line":354,"column":1},"end":{"line":354,"column":1}},"key":"v9uCJZGmzK"},{"type":"paragraph","position":{"start":{"line":356,"column":1},"end":{"line":356,"column":1}},"children":[{"type":"text","value":"Als nächstes visualisieren wir die Arbeitslosenzahlen abhängig vom Jahr.","position":{"start":{"line":356,"column":1},"end":{"line":356,"column":1}},"key":"Zcoe1HzUgm"}],"key":"IgmohKwJMZ"},{"type":"code","lang":"python","value":"fig = px.scatter(data, x = 'Jahr', y = 'Arbeitslosenzahl',\n             title='Arbeitslosenzahlen in Deutschland von 1991 bis 2022')\nfig.show()","position":{"start":{"line":358,"column":1},"end":{"line":362,"column":1}},"key":"EBTjYRfSdw"},{"type":"paragraph","position":{"start":{"line":364,"column":1},"end":{"line":366,"column":1}},"children":[{"type":"text","value":"Aufgrund der Visualisierung ist abzusehen, dass das lineare Regressionsmodell\nkein gutes Modell sein wird. Wir probieren polynomiale Regression für Grad 1 bis\n10 und notieren den jeweiligen R²-Score.","position":{"start":{"line":364,"column":1},"end":{"line":364,"column":1}},"key":"LbefsencGC"}],"key":"wONRXAJ9h2"},{"type":"code","lang":"python","value":"from sklearn.linear_model import LinearRegression\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.preprocessing import PolynomialFeatures\n\n\n# Auswahl des Modells\nmodel = LinearRegression()\n\n\n# Adaption der Daten\ndata_train, data_test = train_test_split(data, random_state=42)\n\nX_train = data_train[['Jahr']]\ny_train = data_train['Arbeitslosenzahl']\n\nX_test = data_test[['Jahr']]\ny_test = data_test['Arbeitslosenzahl']\n\n# Training für Polynomgrad 1 bis 5\nfor grad in [1, 2, 3, 4, 5]:\n    polynom_transformator = PolynomialFeatures(degree = grad)\n\n    X_train_transformiert =  polynom_transformator.fit_transform(X_train)\n    model.fit(X_train_transformiert, y_train)\n\n    # Validierung mit Testdaten\n    r2_score_train = model.score(X_train_transformiert, y_train)\n    X_test_transformiert = polynom_transformator.transform(X_test)\n    r2_score_test  = model.score(X_test_transformiert, y_test)\n\n    # Vergleich der Modelle\n    print(f'Grad {grad}: R2-Score Trainingsdaten: {r2_score_train:.2f} \\t R2-Score Testdaten: {r2_score_test}')","position":{"start":{"line":368,"column":1},"end":{"line":401,"column":1}},"key":"jP0mveTJ8k"},{"type":"paragraph","position":{"start":{"line":403,"column":1},"end":{"line":404,"column":1}},"children":[{"type":"text","value":"Ab Grad 3 gibt es keine Veränderung mehr. Der R²-Score für die Testdaten ist\ndeutlich kleiner als für die Trainingsdaten.  Dies deutet darauf hin, dass das Modell bereits anfängt zu overfitten. Dennoch wählen wir Grad 3, da höhere Grade zu noch schlechteren Testscores führen.","position":{"start":{"line":403,"column":1},"end":{"line":403,"column":1}},"key":"AFb1uDVHXn"}],"key":"o4roioAB55"},{"type":"code","lang":"python","value":"\n# Wähle Grad 3\npolynom_transformator = PolynomialFeatures(degree = 3)\n\nX_train_transformiert =  polynom_transformator.fit_transform(X_train)\nmodel.fit(X_train_transformiert, y_train)\n\n# Validierung mit Testdaten\nr2_score_train = model.score(X_train_transformiert, y_train)\nX_test_transformiert = polynom_transformator.transform(X_test)\nr2_score_test  = model.score(X_test_transformiert, y_test)\n\n# Vergleich der Modelle\nprint(f'Grad 3: R2-Score Trainingsdaten: {r2_score_train:.2f} \\t R2-Score Testdaten: {r2_score_test}')","position":{"start":{"line":406,"column":1},"end":{"line":421,"column":1}},"key":"ppcps814Qs"},{"type":"code","lang":"python","value":"import numpy as np\nimport plotly.graph_objects as go\n\n# Prognose für die Jahre 1990 bis 2030\nprognose = pd.DataFrame()\nprognose['Jahr'] = np.arange(1990, 2031)\n\nX_prognose = polynom_transformator.transform(prognose[['Jahr']])\nprognose['Arbeitslosenzahl'] = model.predict(X_prognose)\n","position":{"start":{"line":423,"column":1},"end":{"line":434,"column":1}},"key":"Qzbupyi3kp"},{"type":"code","lang":"python","value":"\nfig1 = px.scatter(data, x = 'Jahr', y = 'Arbeitslosenzahl')\nfig2 = px.line(prognose, x = 'Jahr', y = 'Arbeitslosenzahl')\n\nfig = go.Figure(fig1.data + fig2.data)\nfig.show()","position":{"start":{"line":436,"column":1},"end":{"line":443,"column":1}},"key":"o5W1tXQxZa"},{"type":"paragraph","position":{"start":{"line":445,"column":1},"end":{"line":448,"column":1}},"children":[{"type":"text","value":"Da das von uns gewählte Modell ein Polynom dritten Grades ist, schwingt es für\nJahre nach 2020 wieder nach oben. Dieses Verhalten wird nicht von den\nTrainingsdaten gestützt. Daher sollte das Modell nicht für eine Prognose in die\nZukunft genutzt werden.","position":{"start":{"line":445,"column":1},"end":{"line":445,"column":1}},"key":"cMsiLlqe9Y"}],"key":"RYKysngQWe"}],"class":"tip dropdown","key":"xzH8X9MzJe"}],"key":"WalGNRiPBa"}],"key":"KjwseEYrRr"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"8.3 Kodierung und Skalierung","url":"/chapter08-sec03","group":"8. ML-Workflow Datenvorverarbeitung"},"next":{"title":"9.1 Grundideen der Ensemble-Methoden","url":"/chapter09-sec01","group":"9. Ensemble-Methoden (Random Forests und XGBoost)"}}},"domain":"http://localhost:3001"}