{"version":3,"kind":"Notebook","sha256":"4202e7e26bccd30cfc27f4e9467d9010aab7e3f347aa2eed6a202280e537e1a3","slug":"chapter10-sec02","location":"/chapter10/chapter10_sec02.md","dependencies":[],"frontmatter":{"title":"10.2 Training SVM mit Scikit-Learn","kernelspec":{"name":"python3","display_name":"Python 3","language":"python"},"jupytext":{"formats":"ipynb,md:myst","text_representation":{"extension":".md","format_name":"myst","format_version":"0.13","jupytext_version":"1.15.2"}},"content_includes_title":false,"authors":[{"id":"Simone Gramsch","name":"Simone Gramsch"}],"open_access":true,"license":{"content":{"id":"CC-BY-NC-SA-4.0","url":"https://creativecommons.org/licenses/by-nc-sa/4.0/","name":"Creative Commons Attribution Non Commercial Share Alike 4.0 International","CC":true}},"github":"https://github.com/gramschs/book_ml4ing","numbering":{"title":{"offset":1}},"source_url":"https://github.com/gramschs/book_ml4ing/blob/main/chapter10/chapter10_sec02.md","edit_url":"https://github.com/gramschs/book_ml4ing/edit/main/chapter10/chapter10_sec02.md","exports":[{"format":"md","filename":"chapter10_sec02.md","url":"/book_ml4ing/build/chapter10_sec02-8dc7b94d4f313fc173ae104fc87ef9bd.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":17,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"Wenn wir in der Dokumentation von Scikit-Learn\n","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"CAK2bfiEBH"},{"type":"link","url":"https://scikit-learn.org/stable/modules/svm.html","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Scikit-Learn/SVM","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"thcIP7ShPh"}],"urlSource":"https://scikit-learn.org/stable/modules/svm.html","key":"nOIlsatgAM"},{"type":"text","value":" die Support\nVector Machines nachschlagen, so finden wir viele Einträge: SVC, NuSVC,\nLinearSVC, SVR, NuSVR und LinearSVR. Die Varianten mit “C” stehen für\nKlassifikation (englisch Classification) und die Varianten mit “R” für\nRegression. Wir benutzen in diesem Kapitel das Modell SVC.","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"LeLor1okiB"}],"key":"V5prSw59b0"},{"type":"heading","depth":2,"position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"Lernziele","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"x5Cf6Wx7E7"}],"identifier":"lernziele","label":"Lernziele","html_id":"lernziele","implicit":true,"key":"N8fuWKeNp6"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Lernziele","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"iv28CAuApL"}],"key":"wPoMswRDQD"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":28,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Sie können ein SVM-Modell mit der Klasse SVC erzeugen.","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"LryXA9IM5C"}],"key":"dCb0qE3C2I"}],"key":"rxvDihRm8x"},{"type":"listItem","spread":true,"position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Sie können den Parameter C zur Steuerung der Margins einsetzen.","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"nGF77A6YjF"}],"key":"PPs70EGaEf"}],"key":"Tab1JsNart"}],"key":"zEWW0rwYKr"}],"class":"attention","key":"puqSAopiwx"},{"type":"heading","depth":2,"position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"text","value":"Wahl des linearen Kernels","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"gItxhNVfoA"}],"identifier":"wahl-des-linearen-kernels","label":"Wahl des linearen Kernels","html_id":"wahl-des-linearen-kernels","implicit":true,"key":"F4HVEFqv33"},{"type":"paragraph","position":{"start":{"line":34,"column":1},"end":{"line":37,"column":1}},"children":[{"type":"text","value":"Zuerst importieren wir aus Scikit-Learn das entsprechende Modul ‘SVM’ und\ninstantiieren ein Modell. Da wir die etwas allgemeinere Klasse SVC anstatt\nLinearSVC verwenden, müssen wir bereits bei der Erzeugung die Option ","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"IKFLeYXecx"},{"type":"inlineCode","value":"kernel=","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"U7Gg8u8Jsw"},{"type":"text","value":"\nauf linear setzen, also ","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"fMcUvQwvtA"},{"type":"inlineCode","value":"kernel='linear'","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"xmHbJZoVQo"},{"type":"text","value":".","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"IOsx0BTogJ"}],"key":"drkpeclHx7"}],"key":"Ip950i3q5G"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from sklearn import svm\nsvm_modell = svm.SVC(kernel='linear')","key":"ZROcHFvFEZ"},{"type":"outputs","id":"8rk3sxBt_2rgvbQHW_s4c","children":[],"key":"ZZRHNsR0Uq"}],"key":"AiAAKdGY1O"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"children":[{"type":"text","value":"Wir erzeugen uns erneut künstliche Messdaten.","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"pEJCFTTHyc"}],"key":"zDJhabHdHl"}],"key":"hlqiUVnlE3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from sklearn.datasets import make_blobs\nimport matplotlib.pylab as plt; plt.style.use('bmh')\n\n# Erzeugung künstlicher Daten\nX, y = make_blobs(n_samples=60, centers=2, random_state=0, cluster_std=0.50)\n\n# Visualisierung künstlicher Daten\nimport plotly.express as px\n\nfig = px.scatter(x = X[:,0], y = X[:,1],  color=y, color_continuous_scale=['#3b4cc0', '#b40426'],\n                 title='Künstliche Daten',\n                 labels={'x': 'Feature 1', 'y': 'Feature 2'})\nfig.show()","key":"JglnbN8hYM"},{"type":"outputs","id":"S3Q9xledAoOb4GI4vA2Qr","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"application/vnd.plotly.v1+json":{"content":"{\"data\":[{\"hovertemplate\":\"Feature 1=%{x}<br>Feature 2=%{y}<br>color=%{marker.color}<extra></extra>\",\"legendgroup\":\"\",\"marker\":{\"color\":{\"dtype\":\"i1\",\"bdata\":\"AQAAAAABAQEBAQEAAQAAAAEAAQEAAAAAAQAAAAAAAQEBAAAAAQABAQEAAQAAAAEBAQEBAAEAAAEBAAEB\"},\"coloraxis\":\"coloraxis\",\"symbol\":\"circle\"},\"mode\":\"markers\",\"name\":\"\",\"orientation\":\"v\",\"showlegend\":false,\"x\":{\"dtype\":\"f8\",\"bdata\":\"sIfoHSaQ9z87o27rOwnhP3T+Yx/v4fs/LoddGq2S+z+aITiMdu3cP1VrdrpIk/0/kN9ns/vq+T/1FJPnlf75P8cHGNBHIghADLY9aRveAUDDcDuNOqD5P8+q+WqOrOk/hzKHVyXzAEBNeCZzItzwP3CsH8tQrMU/2ung79GW7T+g7FwobLj2PwDG+zXGhb8/BVuDXKuo/T8dlE3xUGT+P0zFHIoryu4/FfUaUmi19T+FH56zERbnP06jfNw0e+Q/yt0twYj5B0DsiWkS9TriP+JckyQdC+k/CmCDVJU49z+o/uUz4jbTvzMfqQNwdvk/RbvFPoG9/j85bAJM3yYBQHA3O3KVogFAy6DiBwj57z99WQ+ej4/+P0kJW4rVK/M/FOQ6eyhlBkAAqmW9WBHnPx9pNXJ5Ufg/o0u9Ju//BEA8LorQxlsDQGITWzNPZNY/9HPvyqXyAUDA7FYD9x/yPySe9dJrF+U/JkA7PqHjAEAyUqOELDsEQOSp/8O61/M/jjdyeZHpB0CqV1YidkYBQGFDOKzRf/c/zscsjgcn8D8wGJ+d8HsAQK9okbDNxfA/j6S9AMbp4D/W+RUXQigFQPzRG1IB5gJAql5T5iqJ9j8xJ3+2Bk4CQD5jo4svDQJA\"},\"xaxis\":\"x\",\"y\":{\"dtype\":\"f8\",\"bdata\":\"cZFKFrmR9T+ibBYk0oEKQALyXtFjJxRAVZBuhQnOEEDp+ELeDsAMQHOzofYVxOA/tksQRrF24z8IOjq0pKT9P6V/d7XsNPo/KsgwZ+QD9D+kq8nVbY7tPzxzS/8ghxFAWYnuxBqU8T9S2f2KsvgRQNUyLbsnyhBAS4v0/U0JEkCo95ahJx72P1oLyg7gHRVAAnPX2WUk+D8ecQjFtp/tP3rYEFdiEhJAZ3mCNmB1EUBNCxTAyFYQQBtXVaz8fhBAJDd/VvWkzD+i939scYYLQIDlWplMnBBA7wNKVZXpEECWRCgfu4USQAUeUVuynhNAbCYn1ELI9D/D+/RK90vmP3YHZcdE+fg/b+usdj3XEEBw8o2EbIUOQK9++GLr4RFA3P2ig5yH/T9U/zRoMLUNQLjl9vRYzPY/JtI516Dv0T/R2T6G+cnuP8XTtz0nxRJA6D93tgdF1j9C0xL6jwMPQDyqp9BafRBAfVWf0OKcDEDxtsFGvT7qP4MTycCbEPI/hexj6Wic9T/naXGy/Cz2P/REhdVd6f0/utIqn/HREUDYlxUKS6b8P78C8Y+qHxRArWn/Gyz9EUBD4W5GsNjpP5AbGHaCvfU/BR538S12D0AYC0+F05TAP7bDvratxOE/\"},\"yaxis\":\"y\",\"type\":\"scatter\"}],\"layout\":{\"template\":{\"data\":{\"histogram2dcontour\":[{\"type\":\"histogram2dcontour\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1,\"#f0f921\"]]}],\"choropleth\":[{\"type\":\"choropleth\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"histogram2d\":[{\"type\":\"histogram2d\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1,\"#f0f921\"]]}],\"heatmap\":[{\"type\":\"heatmap\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1,\"#f0f921\"]]}],\"contourcarpet\":[{\"type\":\"contourcarpet\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"contour\":[{\"type\":\"contour\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1,\"#f0f921\"]]}],\"surface\":[{\"type\":\"surface\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1,\"#f0f921\"]]}],\"mesh3d\":[{\"type\":\"mesh3d\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"scatter\":[{\"fillpattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2},\"type\":\"scatter\"}],\"parcoords\":[{\"type\":\"parcoords\",\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterpolargl\":[{\"type\":\"scatterpolargl\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"bar\":[{\"error_x\":{\"color\":\"#2a3f5f\"},\"error_y\":{\"color\":\"#2a3f5f\"},\"marker\":{\"line\":{\"color\":\"#E5ECF6\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"scattergeo\":[{\"type\":\"scattergeo\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterpolar\":[{\"type\":\"scatterpolar\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"scattergl\":[{\"type\":\"scattergl\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatter3d\":[{\"type\":\"scatter3d\",\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scattermap\":[{\"type\":\"scattermap\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scattermapbox\":[{\"type\":\"scattermapbox\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterternary\":[{\"type\":\"scatterternary\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scattercarpet\":[{\"type\":\"scattercarpet\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"minorgridcolor\":\"white\",\"startlinecolor\":\"#2a3f5f\"},\"baxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"minorgridcolor\":\"white\",\"startlinecolor\":\"#2a3f5f\"},\"type\":\"carpet\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#EBF0F8\"},\"line\":{\"color\":\"white\"}},\"header\":{\"fill\":{\"color\":\"#C8D4E3\"},\"line\":{\"color\":\"white\"}},\"type\":\"table\"}],\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"#E5ECF6\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}]},\"layout\":{\"autotypenumbers\":\"strict\",\"colorway\":[\"#636efa\",\"#EF553B\",\"#00cc96\",\"#ab63fa\",\"#FFA15A\",\"#19d3f3\",\"#FF6692\",\"#B6E880\",\"#FF97FF\",\"#FECB52\"],\"font\":{\"color\":\"#2a3f5f\"},\"hovermode\":\"closest\",\"hoverlabel\":{\"align\":\"left\"},\"paper_bgcolor\":\"white\",\"plot_bgcolor\":\"#E5ECF6\",\"polar\":{\"bgcolor\":\"#E5ECF6\",\"angularaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"radialaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"}},\"ternary\":{\"bgcolor\":\"#E5ECF6\",\"aaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"caxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"}},\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"sequential\":[[0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1,\"#f0f921\"]],\"sequentialminus\":[[0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1,\"#f0f921\"]],\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]]},\"xaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"white\",\"automargin\":true,\"zerolinewidth\":2},\"yaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"white\",\"automargin\":true,\"zerolinewidth\":2},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2},\"yaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2},\"zaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2}},\"shapedefaults\":{\"line\":{\"color\":\"#2a3f5f\"}},\"annotationdefaults\":{\"arrowcolor\":\"#2a3f5f\",\"arrowhead\":0,\"arrowwidth\":1},\"geo\":{\"bgcolor\":\"white\",\"landcolor\":\"#E5ECF6\",\"subunitcolor\":\"white\",\"showland\":true,\"showlakes\":true,\"lakecolor\":\"white\"},\"title\":{\"x\":0.05},\"mapbox\":{\"style\":\"light\"}}},\"xaxis\":{\"anchor\":\"y\",\"domain\":[0,1],\"title\":{\"text\":\"Feature 1\"}},\"yaxis\":{\"anchor\":\"x\",\"domain\":[0,1],\"title\":{\"text\":\"Feature 2\"}},\"coloraxis\":{\"colorbar\":{\"title\":{\"text\":\"color\"}},\"colorscale\":[[0,\"#3b4cc0\"],[1,\"#b40426\"]]},\"legend\":{\"tracegroupgap\":0},\"title\":{\"text\":\"Künstliche Daten\"}},\"config\":{\"plotlyServerURL\":\"https://plot.ly\"}}","content_type":"application/vnd.plotly.v1+json"}}},"key":"Hv4XV83bm3"}],"key":"kpiCNw75Tx"}],"key":"AsEiDF3qHn"},{"type":"block","children":[{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Warnung: Datenskalierung für SVM notwendig","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"ImVQ1JfXhT"}],"key":"Xx2cDndsYQ"},{"type":"paragraph","position":{"start":{"line":64,"column":1},"end":{"line":66,"column":1}},"children":[{"type":"text","value":"SVMs sind empfindlich gegenüber unterschiedlichen Feature-Skalen. Ein Feature mit\nWerten von 0-1000 dominiert ein Feature mit Werten 0-1, auch wenn beide gleich\nwichtig sind. Daher sollten Features vor dem Training skaliert werden.","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"key":"rZuf8b23PS"}],"key":"GCTX6yicaG"}],"class":"warning","key":"SxSZtW2QOb"},{"type":"paragraph","position":{"start":{"line":69,"column":1},"end":{"line":71,"column":1}},"children":[{"type":"text","value":"Eine Skalierung der Daten ist hier nicht erforderlich, da alle Features im\ngleichen Wertebereich liegen. Als nächstes teilen wir die Messdaten in\nTrainings- und Testdaten auf.","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"aPyB3w1Kl9"}],"key":"LLX6waWCxw"}],"key":"Koodgw3FRr"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X, y, random_state=0)","key":"rgDN9L2pAZ"},{"type":"outputs","id":"sV6ZAZnxZ2429uyg-gwct","children":[],"key":"bYy1sGWVkX"}],"key":"xfupTtksyY"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":78,"column":1},"end":{"line":78,"column":1}},"children":[{"type":"text","value":"Nun können wir unser SVM-Modell trainieren:","position":{"start":{"line":78,"column":1},"end":{"line":78,"column":1}},"key":"VBZkjKlw4L"}],"key":"hovjUhFFZa"}],"key":"kMN6EZ6L5Q"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"svm_modell.fit(X_train, y_train);","key":"UDpw7TXfvi"},{"type":"outputs","id":"RP1Jf2MuHooc8g_pnmO7H","children":[],"key":"G6nfip6CYl"}],"key":"a4KEilW3gg"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":84,"column":1},"end":{"line":85,"column":1}},"children":[{"type":"text","value":"Und als nächstes analysieren, wie viele der Testdaten mit dem trainierten Modell\nkorrekt klassifiziert werden.","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"buJB6DLhId"}],"key":"i8tW3ssjKn"}],"key":"k0YvONS3FZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"svm_modell.score(X_test, y_test)","key":"iINBpbXl6w"},{"type":"outputs","id":"GTNbZJJcQ_k-ASEv_6sWC","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"text/plain":{"content":"1.0","content_type":"text/plain"}}},"key":"iy3twNE3Tt"}],"key":"a2Urr13kiL"}],"key":"xv4YO0W6Hi"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":91,"column":1},"end":{"line":95,"column":1}},"children":[{"type":"text","value":"Ein super Ergebnis! Schön wäre es jetzt noch, die gefundene Trenngerade zu\nvisualisieren. Dazu modifizieren wir ein Code-Beispiel aus dem Buch: »Data\nScience mit Python« von Jake VanderPlas (mitp Verlag 2017), ISBN 978-3-95845-\n695-2, siehe\n","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"key":"iWfS8ueImL"},{"type":"link","url":"https://github.com/jakevdp/PythonDataScienceHandbook","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"children":[{"type":"text","value":"https://​github​.com​/jakevdp​/PythonDataScienceHandbook","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"key":"cridi4G4eZ"}],"urlSource":"https://github.com/jakevdp/PythonDataScienceHandbook","error":true,"key":"A0EE3J7vyq"},{"type":"text","value":".","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"key":"XUl4777DrE"}],"key":"FYg8Z0qkPp"}],"key":"xecXTzpVG4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Quelle: VanderPlas \"Data Science mit Python\", S. 482\n# modified by Simone Gramsch\nimport numpy as np\n\ndef plot_svc_grenze(model):\n    # aktuelles Grafik-Fenster auswerten\n    ax = plt.gca()\n    xlim = ax.get_xlim()\n    ylim = ax.get_ylim()\n\n    # Raster für die Auswertung erstellen\n    x = np.linspace(xlim[0], xlim[1], 30)\n    y = np.linspace(ylim[0], ylim[1], 30)\n    Y, X = np.meshgrid(y, x)\n    xy = np.vstack([X.ravel(), Y.ravel()]).T\n\n    # Abstand zur Trennhyperebene berechnen mit eingebauter \n    # decision_function()\n    P = model.decision_function(xy).reshape(X.shape)\n\n    # Entscheidungsgrenzen und Margin darstellen\n    ax.contour(X, Y, P, colors='k', levels=[-1, 0, 1], alpha=0.5, linestyles=['--', '-', '--'])\n\n    # Stützvektoren darstellen\n    ax.scatter(model.support_vectors_[:, 0], model.support_vectors_[:, 1], s=300, linewidth=1, facecolors='none', edgecolors='orange');\n    ax.set_xlim(xlim)\n    ax.set_ylim(ylim)","key":"cYZpxpB0do"},{"type":"outputs","id":"yMb1tfUnWyjA-xScDwqBv","children":[],"key":"m9jnyrRha8"}],"key":"Oqldwj4SFC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"fig, ax = plt.subplots()\nax.scatter(X[:,0], X[:,1], c=y, cmap='coolwarm')\nax.set_xlabel('Feature 1')\nax.set_ylabel('Feature 2')\nax.set_title('SVM mit Soft Margin');\n\nplot_svc_grenze(svm_modell)","key":"W8AS2cGsjs"},{"type":"outputs","id":"ArNVvQS-O8arBmj7RzQb6","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"5b4154fff41fcc2ccc7fbe05ffe36009","path":"/book_ml4ing/build/5b4154fff41fcc2ccc7fbe05ffe36009.png"}}},"key":"euBo9RnblY"}],"key":"t9PHI0FmEt"}],"key":"cTQZW03NXV"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":138,"column":1},"end":{"line":138,"column":1}},"children":[{"type":"text","value":"Der Parameter C","position":{"start":{"line":138,"column":1},"end":{"line":138,"column":1}},"key":"kDqztKLLAH"}],"identifier":"der-parameter-c","label":"Der Parameter C","html_id":"der-parameter-c","implicit":true,"key":"vFtEs6yYVh"},{"type":"paragraph","position":{"start":{"line":140,"column":1},"end":{"line":146,"column":1}},"children":[{"type":"text","value":"Im letzten Abschnitt haben wir uns mit dem Parameter ","position":{"start":{"line":140,"column":1},"end":{"line":140,"column":1}},"key":"qQ0Ht4EOhS"},{"type":"inlineCode","value":"C","position":{"start":{"line":140,"column":1},"end":{"line":140,"column":1}},"key":"vMGTn0jT8r"},{"type":"text","value":" beschäftigt, der\nAusnahmen innerhalb des Sicherheitsstreifens erlaubt. Wir können uns den\nParameter ","position":{"start":{"line":140,"column":1},"end":{"line":140,"column":1}},"key":"PG6X6bjM92"},{"type":"inlineCode","value":"C","position":{"start":{"line":140,"column":1},"end":{"line":140,"column":1}},"key":"JmkgbpHmTX"},{"type":"text","value":" als die “Höhe der Mauer” um den Margin vorstellen. Eine hohe Mauer\n(großes ","position":{"start":{"line":140,"column":1},"end":{"line":140,"column":1}},"key":"QSOVpTKMKO"},{"type":"inlineCode","value":"C","position":{"start":{"line":140,"column":1},"end":{"line":140,"column":1}},"key":"KB4Wu1Bhb3"},{"type":"text","value":") schützt den Sicherheitsbereich streng. Praktisch keine Datenpunkte\ndürfen hinein. Eine niedrige Mauer (kleines ","position":{"start":{"line":140,"column":1},"end":{"line":140,"column":1}},"key":"oJuXT1DIrl"},{"type":"inlineCode","value":"C","position":{"start":{"line":140,"column":1},"end":{"line":140,"column":1}},"key":"s75V0sdr28"},{"type":"text","value":") ist toleranter und lässt mehr\nAusnahmen zu. Als nächstes schauen wir uns an, wie der Parameter ","position":{"start":{"line":140,"column":1},"end":{"line":140,"column":1}},"key":"UcZPC5rxub"},{"type":"inlineCode","value":"C","position":{"start":{"line":140,"column":1},"end":{"line":140,"column":1}},"key":"wkDweaoDHz"},{"type":"text","value":" gesetzt\nwird.","position":{"start":{"line":140,"column":1},"end":{"line":140,"column":1}},"key":"X2JYztmUdo"}],"key":"a7YlWMXpMI"},{"type":"paragraph","position":{"start":{"line":148,"column":1},"end":{"line":149,"column":1}},"children":[{"type":"text","value":"Die Option zum Setzen des Parameters C lautet schlicht und einfach ","position":{"start":{"line":148,"column":1},"end":{"line":148,"column":1}},"key":"XFk6Cy7wTD"},{"type":"inlineCode","value":"C=","position":{"start":{"line":148,"column":1},"end":{"line":148,"column":1}},"key":"RsksyV2aeO"},{"type":"text","value":". Dabei\nmuss C immer positiv sein. Der voreingestellte Standardwert ist ","position":{"start":{"line":148,"column":1},"end":{"line":148,"column":1}},"key":"wJINTW9hVh"},{"type":"inlineCode","value":"C=1","position":{"start":{"line":148,"column":1},"end":{"line":148,"column":1}},"key":"KA8uzMo5A3"},{"type":"text","value":".","position":{"start":{"line":148,"column":1},"end":{"line":148,"column":1}},"key":"Q7aeMrgwMb"}],"key":"bUWKH7Supo"},{"type":"paragraph","position":{"start":{"line":151,"column":1},"end":{"line":153,"column":1}},"children":[{"type":"text","value":"Damit aber besser sichtbar wird, wie sich C auswirkt, vermischen wir die\nkünstlichen Daten stärker. Für die Bewertung der Modelle trennen wir die Daten\nin Trainings- und Testdaten.","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"key":"EZnPnnoJyx"}],"key":"PlpGhnw0FO"}],"key":"fnT0KHpLtU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Erzeugung künstlicher Daten\nX, y = make_blobs(n_samples=60, centers=2, random_state=0, cluster_std=0.80)\nX_train, X_test, y_train, y_test = train_test_split(X, y, random_state=0)\n\n# Visualisierung künstlicher Daten\nimport plotly.express as px\n\nfig = px.scatter(x = X[:,0], y = X[:,1],  color=y, color_continuous_scale=['#3b4cc0', '#b40426'],\n                 title='Künstliche Daten',\n                 labels={'x': 'Feature 1', 'y': 'Feature 2'})\nfig.show()","key":"SrXycqEOTE"},{"type":"outputs","id":"k7ceOokd6wQ5v2TzZABLf","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"application/vnd.plotly.v1+json":{"content":"{\"data\":[{\"hovertemplate\":\"Feature 1=%{x}<br>Feature 2=%{y}<br>color=%{marker.color}<extra></extra>\",\"legendgroup\":\"\",\"marker\":{\"color\":{\"dtype\":\"i1\",\"bdata\":\"AQAAAAABAQEBAQEAAQAAAAEAAQEAAAAAAQAAAAAAAQEBAAAAAQABAQEAAQAAAAEBAQEBAAEAAAEBAAEB\"},\"coloraxis\":\"coloraxis\",\"symbol\":\"circle\"},\"mode\":\"markers\",\"name\":\"\",\"orientation\":\"v\",\"showlegend\":false,\"x\":{\"dtype\":\"f8\",\"bdata\":\"8DpDq2n48T+WSnjY0gbRP2VgzOK0ngFALTTH3kxfAUDSuHkoO5fBPyynjHIHl/s/I2F1mvK89T9fg7q6T9z1PysKDnG8vwxAmLqw/w65AkB2SS4qV0X1P9GXGgWHVeY/xIFZ4x5BAUBYHQOyiJrxPzScAxB5JtS/5C8mQCaZ7D9y3GMiQJ/wPygKhTY34di/efM63D65+z8Ggn79euX8P2b1hdDohO4/mH69FpJc+T/1uCFGjDHiP58XpagiDdw/lmCXv4p+DEBnxjRVI9nUP4mBEC44U+U/h/bKTQ3I+z9nb5a01Q7xvy/1oP83Xv8/EyelrC50/T/hqh4E4pMBQGtWRkHSWQJAf916Zr408D/TQiJINcMDQFIFJNdATfU/cjesT4r3CUDt/GDv/SniPzw9vsu7LfM/vnYWYvu7B0B/FCvYuhsFQBA/TdLilpq/pR3NaOzZAkDeCreYqaDzP35tW70FAd4/rC7bxipWBkBvtLleKoEGQCCwA2oVCeg/nFaeGf9kDEBi8KT0bMYBQD9nXPVI3vE/jJxzEMR48D/TikwgZIIAQPWdFOHNdvE/CYLbTyai0D92jdcVgPwHQOWAeqdLXwRA7o3kA2Ov+j9tPOYUIWwDQOgC7WliBANA\"},\"xaxis\":\"x\",\"y\":{\"dtype\":\"f8\",\"bdata\":\"KpjumKjk+T8D5ZvL0cAFQANSuuTG6hVAiIIGOAOPEEDbK+NbmVcJQEQvfB1ILtM/TuOqGznQ2z+ObJ2X3WcDQHLXNDIXqABAue9eGiFo9z+LcWQNFw7uP/lTzscotxFAA1hbsBGC8z9P9x503mwSQO/snSfNiBBArK2pxXCHEkC2O893WcX6P1xH/0YndRdAEgHQ0YkC/j+BrZXyvinuP8PCo7r3lRJA2F0mIMGaEUBcW+teaqAPQCtaEUOIEBBAucUTZQ0cx78EXd6l0GEHQAE+GotuPxBAsm4yHha7EEBXCZbHhU4TQG6YClsREBVA7+y1yFGi+D+IvqmVjHDiP8shTLQhV/8/GOEDurydEECzVI7/+ywMQLLMfJpsSBJAnm8k16NQA0BUaWYFz98KQDVSAsoO3Ps/vsd/fSYXt79P9w9HewPwP9VUFZL/sxNA2NqL9hWUkj9qvC9VzvYMQC3fYbDrDRBAYSaq31IfCUA5Hb5bycHoP63OhXZGSfQ/fcOw6sH1+T8bjPnFFN36PxhCphjYngNAKVPN+twuEkCatxmpYpwCQJg510hr3hVA4XchXAd0EkAilDlbgR7oP4/bnZi3Kvo/1QCdejGuDUCAbLAmiDTVv+f8pepgY9Y/\"},\"yaxis\":\"y\",\"type\":\"scatter\"}],\"layout\":{\"template\":{\"data\":{\"histogram2dcontour\":[{\"type\":\"histogram2dcontour\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1,\"#f0f921\"]]}],\"choropleth\":[{\"type\":\"choropleth\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"histogram2d\":[{\"type\":\"histogram2d\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1,\"#f0f921\"]]}],\"heatmap\":[{\"type\":\"heatmap\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1,\"#f0f921\"]]}],\"contourcarpet\":[{\"type\":\"contourcarpet\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"contour\":[{\"type\":\"contour\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1,\"#f0f921\"]]}],\"surface\":[{\"type\":\"surface\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1,\"#f0f921\"]]}],\"mesh3d\":[{\"type\":\"mesh3d\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"scatter\":[{\"fillpattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2},\"type\":\"scatter\"}],\"parcoords\":[{\"type\":\"parcoords\",\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterpolargl\":[{\"type\":\"scatterpolargl\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"bar\":[{\"error_x\":{\"color\":\"#2a3f5f\"},\"error_y\":{\"color\":\"#2a3f5f\"},\"marker\":{\"line\":{\"color\":\"#E5ECF6\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"scattergeo\":[{\"type\":\"scattergeo\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterpolar\":[{\"type\":\"scatterpolar\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"scattergl\":[{\"type\":\"scattergl\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatter3d\":[{\"type\":\"scatter3d\",\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scattermap\":[{\"type\":\"scattermap\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scattermapbox\":[{\"type\":\"scattermapbox\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterternary\":[{\"type\":\"scatterternary\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scattercarpet\":[{\"type\":\"scattercarpet\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"minorgridcolor\":\"white\",\"startlinecolor\":\"#2a3f5f\"},\"baxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"minorgridcolor\":\"white\",\"startlinecolor\":\"#2a3f5f\"},\"type\":\"carpet\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#EBF0F8\"},\"line\":{\"color\":\"white\"}},\"header\":{\"fill\":{\"color\":\"#C8D4E3\"},\"line\":{\"color\":\"white\"}},\"type\":\"table\"}],\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"#E5ECF6\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}]},\"layout\":{\"autotypenumbers\":\"strict\",\"colorway\":[\"#636efa\",\"#EF553B\",\"#00cc96\",\"#ab63fa\",\"#FFA15A\",\"#19d3f3\",\"#FF6692\",\"#B6E880\",\"#FF97FF\",\"#FECB52\"],\"font\":{\"color\":\"#2a3f5f\"},\"hovermode\":\"closest\",\"hoverlabel\":{\"align\":\"left\"},\"paper_bgcolor\":\"white\",\"plot_bgcolor\":\"#E5ECF6\",\"polar\":{\"bgcolor\":\"#E5ECF6\",\"angularaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"radialaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"}},\"ternary\":{\"bgcolor\":\"#E5ECF6\",\"aaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"caxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"}},\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"sequential\":[[0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1,\"#f0f921\"]],\"sequentialminus\":[[0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1,\"#f0f921\"]],\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]]},\"xaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"white\",\"automargin\":true,\"zerolinewidth\":2},\"yaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"white\",\"automargin\":true,\"zerolinewidth\":2},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2},\"yaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2},\"zaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2}},\"shapedefaults\":{\"line\":{\"color\":\"#2a3f5f\"}},\"annotationdefaults\":{\"arrowcolor\":\"#2a3f5f\",\"arrowhead\":0,\"arrowwidth\":1},\"geo\":{\"bgcolor\":\"white\",\"landcolor\":\"#E5ECF6\",\"subunitcolor\":\"white\",\"showland\":true,\"showlakes\":true,\"lakecolor\":\"white\"},\"title\":{\"x\":0.05},\"mapbox\":{\"style\":\"light\"}}},\"xaxis\":{\"anchor\":\"y\",\"domain\":[0,1],\"title\":{\"text\":\"Feature 1\"}},\"yaxis\":{\"anchor\":\"x\",\"domain\":[0,1],\"title\":{\"text\":\"Feature 2\"}},\"coloraxis\":{\"colorbar\":{\"title\":{\"text\":\"color\"}},\"colorscale\":[[0,\"#3b4cc0\"],[1,\"#b40426\"]]},\"legend\":{\"tracegroupgap\":0},\"title\":{\"text\":\"Künstliche Daten\"}},\"config\":{\"plotlyServerURL\":\"https://plot.ly\"}}","content_type":"application/vnd.plotly.v1+json"}}},"key":"RsOznHVi1m"}],"key":"TrhqDns6Uy"}],"key":"iK9nYQ2zqk"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":169,"column":1},"end":{"line":171,"column":1}},"children":[{"type":"text","value":"Zuerst wählen wir ein sehr hohes ","position":{"start":{"line":169,"column":1},"end":{"line":169,"column":1}},"key":"EyGJxzXRNY"},{"type":"inlineCode","value":"C=1000000","position":{"start":{"line":169,"column":1},"end":{"line":169,"column":1}},"key":"vSOxaV53zL"},{"type":"text","value":". Das ist ein Hard Margin, eine\npraktisch nicht durchdringbare Mauer, die keine Datenpunkte in den\nSicherheitsbereich lässt.","position":{"start":{"line":169,"column":1},"end":{"line":169,"column":1}},"key":"vsYSthmBK7"}],"key":"RZMQCCqUMa"}],"key":"no3wzcMlM2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Wahl des Modells mit linearem Kern und großem C\nsvm_modell = svm.SVC(kernel='linear', C=1000000)\n\n# Training und Bewertung\nsvm_modell.fit(X_train, y_train);\nscore = svm_modell.score(X_test, y_test)\nprint(f'Score auf den Testdaten: {score:.2f}')\n\n# Visualisierung\nfig, ax = plt.subplots()\nax.scatter(X[:,0], X[:,1], c=y, cmap='coolwarm')\nax.set_xlabel('Feature 1')\nax.set_ylabel('Feature 2')\nax.set_title('SVM mit Hard Margin');\nplot_svc_grenze(svm_modell)","key":"oXAJU3Lk1J"},{"type":"outputs","id":"wUPIYcXicVGKrwdMKqbwB","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Score auf den Testdaten: 1.00\n"},"key":"i7nMLqhDTa"},{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"75be53e4f0cf6b72a38af3847d2f0b5e","path":"/book_ml4ing/build/75be53e4f0cf6b72a38af3847d2f0b5e.png"}}},"key":"Xm4gt0ZLr0"}],"key":"XbbEI1Rwx4"}],"key":"xJIRTejDLq"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":191,"column":1},"end":{"line":192,"column":1}},"children":[{"type":"text","value":"Nun reduzieren wir den Wert des Parameters ","position":{"start":{"line":191,"column":1},"end":{"line":191,"column":1}},"key":"dfivmtEiJB"},{"type":"inlineCode","value":"C","position":{"start":{"line":191,"column":1},"end":{"line":191,"column":1}},"key":"TNA8qNvi81"},{"type":"text","value":" deutlich auf ","position":{"start":{"line":191,"column":1},"end":{"line":191,"column":1}},"key":"lYR7yNshqJ"},{"type":"inlineCode","value":"C=1","position":{"start":{"line":191,"column":1},"end":{"line":191,"column":1}},"key":"fWs8r0FHbX"},{"type":"text","value":". Vereinzelt\nliegen Datenpunkte nun im Sicherheitsbereich, d.h. wir haben einen Soft Margin.","position":{"start":{"line":191,"column":1},"end":{"line":191,"column":1}},"key":"Z5k4ExFE9r"}],"key":"GkOYzbe6Bh"}],"key":"D73nYAWPJO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Wahl des Modells mit linearem Kern und kleinem C\nsvm_modell = svm.SVC(kernel='linear', C=1)\n\n# Training und Bewertung\nsvm_modell.fit(X_train, y_train);\nscore = svm_modell.score(X_test, y_test)\nprint(f'Score auf den Testdaten: {score:.2f}')\n\n# Visualisierung\nfig, ax = plt.subplots()\nax.scatter(X[:,0], X[:,1], c=y, cmap='coolwarm')\nax.set_xlabel('Feature 1')\nax.set_ylabel('Feature 2')\nax.set_title('SVM mit Soft Margin');\nplot_svc_grenze(svm_modell)","key":"f3yroQa7dg"},{"type":"outputs","id":"DKw3Q1W9iCglTqyVPftav","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Score auf den Testdaten: 1.00\n"},"key":"ceBclrQr4g"},{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"b60ed4d721ba11d8950d536bf672c29f","path":"/book_ml4ing/build/b60ed4d721ba11d8950d536bf672c29f.png"}}},"key":"tqDDyR5jEw"}],"key":"NGunvQ1zVg"}],"key":"mUdu7bcDAy"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":212,"column":1},"end":{"line":214,"column":1}},"children":[{"type":"text","value":"Die Visualisierung zeigt, dass bei kleinem ","position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"key":"qQx1mfYQBj"},{"type":"inlineCode","value":"C","position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"key":"dE3IlwyVjy"},{"type":"text","value":" mehr Stützvektoren (orange\neingekreist) vorhanden sind, und einige davon innerhalb des Margins liegen oder\ndie Klassifikationsgrenze verletzen.","position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"key":"YTcNXt54CD"}],"key":"fjSFozHEuu"},{"type":"paragraph","position":{"start":{"line":216,"column":1},"end":{"line":220,"column":1}},"children":[{"type":"text","value":"Welches ","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"key":"oCshmFb5L5"},{"type":"inlineCode","value":"C","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"key":"J08KsyIojh"},{"type":"text","value":" sollen wir wählen? Beide Modelle liefern den gleichen Score von 1.0\nauf den Testdaten. Das kleinere ","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"key":"ccZ6Oe1KkB"},{"type":"inlineCode","value":"C","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"key":"fvF5cH7Rp4"},{"type":"text","value":" führt jedoch zu einem robusteren Modell mit\nbreiterem Margin. In der Praxis wird ","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"key":"LsASvgMGDR"},{"type":"inlineCode","value":"C","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"key":"UOIR534hVH"},{"type":"text","value":" oft durch Kreuzvalidierung\n(Crossvalidation) optimiert, was wir in einem späteren Kapitel aufgreifen\nwerden.","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"key":"eRlioEVnHc"}],"key":"oX1fXsX4Xk"},{"type":"heading","depth":2,"position":{"start":{"line":222,"column":1},"end":{"line":222,"column":1}},"children":[{"type":"text","value":"Zusammenfassung","position":{"start":{"line":222,"column":1},"end":{"line":222,"column":1}},"key":"Q8FqNCAbUU"}],"identifier":"zusammenfassung","label":"Zusammenfassung","html_id":"zusammenfassung","implicit":true,"key":"X6u1XiZlDN"},{"type":"paragraph","position":{"start":{"line":224,"column":1},"end":{"line":230,"column":1}},"children":[{"type":"text","value":"Verwenden wir den SVC-Klassifikator aus dem Modul SVM von Scikit-Learn, können\nwir mittels der Option ","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"key":"MPpVraucEp"},{"type":"inlineCode","value":"kernel='linear'","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"key":"Ar5polYqKo"},{"type":"text","value":" eine binäre Klassifikation durchführen,\nbei der die Trennungsgerade den größtmöglichen Abstand zwischen den Gruppen von\nPunkten erzeugt, also einen möglichst großen Margin. Sind die Daten nicht linear\ntrennbar, so können wir mit der Option ","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"key":"kh7pAsv5iW"},{"type":"inlineCode","value":"C=","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"key":"LZaIezTyCo"},{"type":"text","value":" steuern, wie viele Ausnahmen erlaubt\nwerden sollen. Mit Ausnahmen sind Punkte innerhalb des Margins gemeint. Im\nnächsten Abschnitt betrachten wir nichtlineare Trennungsgrenzen.","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"key":"QQhdVLiy82"}],"key":"TLJUaZvLWP"}],"key":"QCE2vDj3jw"}],"key":"KK8IBojn0I"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"10.1 Maximiere den Rand, aber soft","url":"/chapter10-sec01","group":"10. Support Vector Machines"},"next":{"title":"10.3 Nichtlineare SVM","url":"/chapter10-sec03","group":"10. Support Vector Machines"}}},"domain":"http://localhost:3001"}