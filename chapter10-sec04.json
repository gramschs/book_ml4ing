{"version":3,"kind":"Notebook","sha256":"490c52537e614e32ee07404834a7afa3a220293488bc8abb158fafb3357e30a3","slug":"chapter10-sec04","location":"/chapter10/chapter10_sec04.md","dependencies":[],"frontmatter":{"title":"Übung","kernelspec":{"name":"python3","display_name":"Python 3","language":"python"},"jupytext":{"formats":"ipynb,md:myst","text_representation":{"extension":".md","format_name":"myst","format_version":"0.13","jupytext_version":"1.15.2"}},"content_includes_title":false,"authors":[{"id":"Simone Gramsch","name":"Simone Gramsch"}],"open_access":true,"license":{"content":{"id":"CC-BY-NC-SA-4.0","url":"https://creativecommons.org/licenses/by-nc-sa/4.0/","name":"Creative Commons Attribution Non Commercial Share Alike 4.0 International","CC":true}},"github":"https://github.com/gramschs/book_ml4ing","numbering":{"title":{"offset":1}},"source_url":"https://github.com/gramschs/book_ml4ing/blob/main/chapter10/chapter10_sec04.md","edit_url":"https://github.com/gramschs/book_ml4ing/edit/main/chapter10/chapter10_sec04.md","exports":[{"format":"md","filename":"chapter10_sec04.md","url":"/build/chapter10_sec04-801fa91a800e220ed3b227e512564f20.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":17,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"Auf der Internetseite\n[","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"FGfn0pxmaI"},{"type":"link","url":"https://archive.ics.uci.edu/dataset/151/connectionist+bench+sonar+mines+vs+rocks","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"https://​archive​.ics​.uci​.edu​/dataset​/151​/connectionist+bench+sonar+mines+vs+rocks","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"FNzwPjhUau"}],"urlSource":"https://archive.ics.uci.edu/dataset/151/connectionist+bench+sonar+mines+vs+rocks","key":"YKV3UwpfL0"},{"type":"text","value":"]\nfinden Sie einen Datensatz mit Sonarsignalen. Die Muster der Signale sind durch\n60 Zahlenwerte codiert (es handelt sich um die Energie zu bestimmten Frequenzen,\nnormalisiert auf [0,1]). Darüber hinaus wird angegeben, ob das Sonarsignal\nGestein (= Stein) oder Metall detektiert hat.","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"lqBOhXNft7"}],"key":"FKXCcu8Cn6"},{"type":"paragraph","position":{"start":{"line":24,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"Laden Sie nun die Datei ‘metall_oder_stein.csv’. Führen Sie eine explorative\nDatenanalyse durch. Lassen Sie dann alle Ihnen bekannten Klassifikationsmodelle\ntrainieren und validieren, um die Materialeigenschaft Stein/Metall auf Basis der\nnumerischen Werte zu prognostizieren.","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"CZTfA08aWj"}],"key":"GT318sfaVn"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Überblick über die Daten","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"kV3YAPNMgD"}],"key":"CskOY2yIhI"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":31,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Welche Daten enthält der Datensatz?","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"ei333R1I5o"}],"key":"r67cGkUIPP"}],"key":"QfoUu6fQLC"},{"type":"listItem","spread":true,"position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Wie viele Datenpunkte und Merkmale gibt es?","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"WDtsGk5Gl6"}],"key":"TLiwhX4prN"}],"key":"Zv3ZdILwVX"},{"type":"listItem","spread":true,"position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Sind die Daten vollständig?","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"RJf8UsjuTJ"}],"key":"QvY77D1VHx"}],"key":"gW6nr6OsBh"},{"type":"listItem","spread":true,"position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Welche Datentypen haben die Merkmale?","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"qFmKoGW3TX"}],"key":"zkv0bvhHvP"}],"key":"Yn4iF1F3NO"},{"type":"listItem","spread":true,"position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Gibt es Merkmale mit unerwarteten Datentypen?","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"RVby2rz3he"}],"key":"Ww4DPawfvf"}],"key":"B1Pvrmy5mB"}],"key":"mBTwtvESop"}],"class":"tip","key":"WY0SnvO0ai"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Lösung","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"oxZatJOivT"}],"key":"DfFtNgeLo2"},{"type":"code","lang":"python","value":"import pandas as pd\n\n# Import der Daten (zwei Kommentarzeilen werden übersprungen)\ndaten = pd.read_csv('metall_oder_stein.csv', skiprows=2)\ndaten.info()\n\n# Check der Vollständigkeit:\nprint(daten.isnull().sum())\n\n# Blick in die Daten:\ndaten.head(10)","position":{"start":{"line":41,"column":1},"end":{"line":53,"column":1}},"key":"HQ7vyueF7o"},{"type":"paragraph","position":{"start":{"line":54,"column":1},"end":{"line":56,"column":1}},"children":[{"type":"text","value":"Der Datensatz enthält 208 Einträge (Datenpunkte) und 61 Merkmale. Die ersten 60\nMerkmale Signal01 bis Signal60 werden durch Floats repräsentiert, das Merkmal\nMaterial wird durch Objekte repräsentiert.","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"NA614yuIep"}],"key":"TZqvNI0FJE"},{"type":"paragraph","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"children":[{"type":"text","value":"Die Daten sind vollständig.","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"key":"dHMm6oYhTJ"}],"key":"iIZCffAgTj"},{"type":"paragraph","position":{"start":{"line":60,"column":1},"end":{"line":62,"column":1}},"children":[{"type":"text","value":"Die ersten 10 Zeilen zeigen in den Spalten Signal01 bis Signal60 numerische\nWerte. In der letzten Spalte Material wird der String ‘Stein’ aufgelistet. Ein\nkurzer Test mit","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"bmMzp4Z0QN"}],"key":"ROWj8WwY4Q"},{"type":"code","lang":"python","value":"daten['Material'].unique()","position":{"start":{"line":64,"column":1},"end":{"line":66,"column":1}},"key":"jEETSnhp1b"},{"type":"paragraph","position":{"start":{"line":68,"column":1},"end":{"line":69,"column":1}},"children":[{"type":"text","value":"zeigt, dass in dieser Spalte lediglich die beiden Einträge ‘Stein’ und ‘Metall’\nauftreten. Insgesamt sind die Werte der Merkmale für die Datentypen plausibel.","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"key":"QrnQ6G69mF"}],"key":"wDMI9fUbKH"}],"class":"tip dropdown","key":"SsctdPruBt"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Statistik der numerischen Daten","position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"key":"CRfY0uwbcw"}],"key":"ejstpawUHE"},{"type":"paragraph","position":{"start":{"line":74,"column":1},"end":{"line":76,"column":1}},"children":[{"type":"text","value":"Erstellen Sie eine Übersicht der statistischen Kennzahlen für die numerischen\nDaten. Interpretieren Sie die statistischen Kennzahlen. Gibt es Auffälligkeiten?\nSind die Werte plausibel?","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"key":"pHMlU9ZVja"}],"key":"JvP3d6pDLT"}],"class":"tip","key":"Y7flgyMwbX"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Lösung","position":{"start":{"line":79,"column":1},"end":{"line":79,"column":1}},"key":"Aw308MBfR9"}],"key":"Wx5F2uZgjF"},{"type":"code","lang":"python","value":"daten.describe()","position":{"start":{"line":82,"column":1},"end":{"line":84,"column":1}},"key":"hoRYRDd75D"},{"type":"paragraph","position":{"start":{"line":85,"column":1},"end":{"line":87,"column":1}},"children":[{"type":"text","value":"Die statistischen Kennzahlen lassen sich aufgrund der großen Anzahl an Merkmalen\nso kaum interpretieren. Daher hilft hier ein Boxplot der numerischen Daten\nweiter.","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"key":"nvT4qKybC2"}],"key":"nmBEZAwlKC"},{"type":"code","lang":"python","value":"import plotly.express as px\n\nfig = px.box(daten.drop('Material', axis=1), \n             title='Stein oder Metall',\n             labels={'variable': 'Merkmal', 'value':'Wert'})\nfig.show()","position":{"start":{"line":89,"column":1},"end":{"line":96,"column":1}},"key":"h3Rc7RH7K0"},{"type":"paragraph","position":{"start":{"line":97,"column":1},"end":{"line":102,"column":1}},"children":[{"type":"text","value":"Die Medianwerte scheinen einem Muster zu folgen. Beginnend bei Merkmal Signal01\nsteigen sie bis zu Signal26, wo der Median den Wert 0.7545 erreicht, um dann\nwieder abzufallen. Ab Signal50 liegt der Median unter 0.0179. Bei Eigenschaften\nmit einem größeren Median ist auch der Interquartilsabstand (IQR) größer, dafür\ngibt es keine Ausreißer. Das Maximum liegt bei 1, was konsistent mit der\nNormalisierung auf [0,1] ist.","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"key":"fC08kgMwXg"}],"key":"E6laxQWSnw"}],"class":"tip dropdown","key":"X9tVl9cwwf"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Statistik der kategorialen Merkmale","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"key":"tv9ntfD0J6"}],"key":"TNoXy1vdWV"},{"type":"paragraph","position":{"start":{"line":107,"column":1},"end":{"line":109,"column":1}},"children":[{"type":"text","value":"Wie viele Einträge gibt es für Metall oder Stein? Visualisieren Sie die\nVerteilung mit einem Balkendiagramm der Klassenverteilung. Ist der Datensatz\nausgewogen?","position":{"start":{"line":107,"column":1},"end":{"line":107,"column":1}},"key":"afHVoOHEnD"}],"key":"xPg2QiD3xD"}],"class":"tip","key":"PcGvv67Rvv"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Lösung","position":{"start":{"line":112,"column":1},"end":{"line":112,"column":1}},"key":"TRqaQO9xWa"}],"key":"HYMrjidAEm"},{"type":"code","lang":"python","value":"# Berechnung der Anzahl der Einträge\nprint(daten['Material'].value_counts())\n\n# Visualisierung als Balkendiagramm\nfig = px.bar(daten['Material'].value_counts(),\n             title='Stein oder Metall')\nfig.update_layout(\n    yaxis_title='Anzahl',\n    xaxis_title='Material',\n    showlegend=False\n)\nfig.show()","position":{"start":{"line":115,"column":1},"end":{"line":128,"column":1}},"key":"ShXFCGiKJk"},{"type":"paragraph","position":{"start":{"line":129,"column":1},"end":{"line":130,"column":1}},"children":[{"type":"text","value":"Im Datensatz sind 111 Proben Metall und 97 Stein. Damit sind 53 % der Proben\nMetall und 47 % Stein, was ungefähr gleichverteilt ist.","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"naV8dq7G6l"}],"key":"aPR8ODLqNR"}],"class":"tip dropdown","key":"QkyDEmn7z2"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Vorbereitung der Daten für das Training","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"oOW7tmQHr5"}],"key":"UDs0LjH00O"},{"type":"paragraph","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"children":[{"type":"text","value":"Bereiten Sie die Daten für das maschinelle Lernen vor:","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"key":"K2Dw8x1OJM"}],"key":"bwWR8buWjp"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":136,"column":1},"end":{"line":140,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":136,"column":1},"end":{"line":136,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Kodieren Sie die kategoriale Variable Material mit ","position":{"start":{"line":136,"column":1},"end":{"line":136,"column":1}},"key":"mv2vnW5IL0"},{"type":"inlineCode","value":"replace()","position":{"start":{"line":136,"column":1},"end":{"line":136,"column":1}},"key":"rJecUcv7qU"},{"type":"text","value":".","position":{"start":{"line":136,"column":1},"end":{"line":136,"column":1}},"key":"A2UZnPzQFo"}],"key":"MQbqCI65Kc"}],"key":"y6CxJNCZxQ"},{"type":"listItem","spread":true,"position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Trennen Sie die Merkmale (Input X) und die Zielgröße (Output y).","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"key":"yXJOV8e7I1"}],"key":"CZarSnEweC"}],"key":"YzW2OpSrD9"},{"type":"listItem","spread":true,"position":{"start":{"line":138,"column":1},"end":{"line":138,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Teilen Sie die Daten in Trainings- und Testdaten im Verhältnis 80:20 auf.","position":{"start":{"line":138,"column":1},"end":{"line":138,"column":1}},"key":"YXYrlJdTNz"}],"key":"nYpUJMhcsU"}],"key":"isAPwjJujh"},{"type":"listItem","spread":true,"position":{"start":{"line":139,"column":1},"end":{"line":140,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Skalieren Sie - falls notwendig - die Trainingsdaten mit ","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"key":"qxrvjkHczt"},{"type":"inlineCode","value":"fit_transform()","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"key":"NoS7RPzm7v"},{"type":"text","value":"\nund die Testdaten mit ","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"key":"RbVOVMFKWd"},{"type":"inlineCode","value":"transform()","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"key":"oKTck55Esy"},{"type":"text","value":".","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"key":"TKtxW18WEI"}],"key":"fgRdwJRQSQ"}],"key":"fImMsmsnFG"}],"key":"NhKf3gQKB1"}],"class":"tip","key":"gzGQLbO2vu"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Lösung","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"key":"p4yyNbbe2g"}],"key":"qcTk6gg9Z1"},{"type":"code","lang":"python","value":"from sklearn.model_selection import train_test_split\n\n# Kodierung mit Check (sollte [0 1] ausgeben)\ndaten['Material'] = daten['Material'].replace({'Stein': '0', 'Metall': '1'}).astype(int)\nprint(daten['Material'].unique())\n\n# Aufteilung in Input/Output\nX = daten.drop('Material', axis=1)\ny = daten['Material']\n\n# Split 80:20\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=0)\n\n# Prüfen der Wertebereiche\nprint(X.min().min(), X.max().max())","position":{"start":{"line":146,"column":1},"end":{"line":162,"column":1}},"key":"mqoJJJTJtL"},{"type":"paragraph","position":{"start":{"line":163,"column":1},"end":{"line":164,"column":1}},"children":[{"type":"text","value":"Da die Signaldaten alle im Intervall [0,1] liegen, brauchen wir die Daten\nnicht skalieren.","position":{"start":{"line":163,"column":1},"end":{"line":163,"column":1}},"key":"Smcq3a9fZd"}],"key":"EMJtNW0ioy"}],"class":"tip dropdown","key":"ack9U7HcQv"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"ML-Modell Entscheidungsbaum","position":{"start":{"line":167,"column":1},"end":{"line":167,"column":1}},"key":"nfURn2FsSi"}],"key":"ZKLqrAT3MG"},{"type":"paragraph","position":{"start":{"line":169,"column":1},"end":{"line":169,"column":1}},"children":[{"type":"text","value":"Trainieren Sie einen Entscheidungsbaum und bewerten Sie das trainierte Modell.","position":{"start":{"line":169,"column":1},"end":{"line":169,"column":1}},"key":"jWS60ClFwB"}],"key":"VnZ8ps11Ci"}],"class":"tip","key":"fu6CFJZYRf"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Lösung","position":{"start":{"line":172,"column":1},"end":{"line":172,"column":1}},"key":"qh4y6BcYHB"}],"key":"PdqTcgriaF"},{"type":"code","lang":"python","value":"from sklearn.tree import DecisionTreeClassifier\n\n# Instanziierung des Entscheidungsbaums mit Training\nmodell_baum = DecisionTreeClassifier()\nmodell_baum.fit(X_train,y_train)\n\n# Bewertung\nscore_train = modell_baum.score(X_train, y_train)\nscore_test = modell_baum.score(X_test, y_test)\nprint(f'Score Trainingsdaten Entscheidungsbaum: {score_train :.2f}')\nprint(f'Score Testdaten Entscheidungsbaum: {score_test :.2f}')","position":{"start":{"line":175,"column":1},"end":{"line":187,"column":1}},"key":"l0b0cMChKa"},{"type":"paragraph","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"children":[{"type":"text","value":"Der Trainingsscore ist 1.00, der Testscore 0.79; ein Zeichen für Overfitting.","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"key":"cyIOvTMszh"}],"key":"CpfefQGqLO"}],"class":"tip dropdown","key":"oGeqEtPXJI"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"ML-Modell Random Forest","position":{"start":{"line":191,"column":1},"end":{"line":191,"column":1}},"key":"xi839WL6jx"}],"key":"TVHu2Gp5I5"},{"type":"paragraph","position":{"start":{"line":193,"column":1},"end":{"line":196,"column":1}},"children":[{"type":"text","value":"Trainieren Sie nun einen Random Forest mit 1, 5, 10, 20, 50 und 100 Bäumen auf\ndenselben Daten. Berechnen Sie wieder die Scores für Training und Test. Wie\nunterscheiden sich die Ergebnisse vom einzelnen Entscheidungsbaum? Welches\nRandom-Forest-Modell würden Sie wählen?","position":{"start":{"line":193,"column":1},"end":{"line":193,"column":1}},"key":"Guhd6hVZYx"}],"key":"D4hUTQGjrl"},{"type":"paragraph","position":{"start":{"line":198,"column":1},"end":{"line":199,"column":1}},"children":[{"type":"text","value":"Bewerten Sie darüber hinaus mit der Feature Importance, welche Signale am\nwichtigsten sind.","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"ihuJB3ukrH"}],"key":"sz9vq13kW4"}],"class":"tip","key":"aFnIBpmTEG"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Lösung","position":{"start":{"line":202,"column":1},"end":{"line":202,"column":1}},"key":"JeuRr581kd"}],"key":"i6tAmRgHl8"},{"type":"code","lang":"python","value":"from sklearn.ensemble import RandomForestClassifier\n\nfor n in [1, 5, 10, 20, 50, 100]:\n    # Instanziierung des Random-Forest-Modells und Training\n    modell_rf = RandomForestClassifier(n_estimators=n, random_state=0)\n    modell_rf.fit(X_train, y_train)\n\n    # Bewertung\n    score_train = modell_rf.score(X_train, y_train)\n    score_test = modell_rf.score(X_test, y_test)\n    print(f'Anzahl Entscheidungsbäume: {n}')\n    print(f'Score Training: {score_train :.2f} | Score Test: {score_test :.2f}')\n    print('')\n\n# bestes RF-Modell wählen\nmodell_rf_final = RandomForestClassifier(n_estimators=50, random_state=0)\nmodell_rf_final.fit(X_train, y_train)\n\n# Feature Importance extrahieren\nimportance = pd.DataFrame({\n    'Merkmal': X_train.columns,\n    'Feature Importance': modell_rf_final.feature_importances_\n}).sort_values('Feature Importance', ascending=False)\n\n# die 5 wichtigsten Merkmale anzeigen\nimportance.head(5)","position":{"start":{"line":205,"column":1},"end":{"line":232,"column":1}},"key":"oRpGfxyeUQ"},{"type":"paragraph","position":{"start":{"line":233,"column":1},"end":{"line":237,"column":1}},"children":[{"type":"text","value":"Das Random-Forest-Modell ist besser verallgemeinerbar als der Entscheidungsbaum.\nFür einen Random Forest aus 50 Entscheidungsbäumen erhalten wir einen\nTrainingsscore von 1.00 und einen Testscore von 0.88. Noch mehr\nEntscheidungsbäume führen zu keinem besseren Ergebnis, so dass wir dieses\nModell wählen würden.","position":{"start":{"line":233,"column":1},"end":{"line":233,"column":1}},"key":"mRIFzWmCjd"}],"key":"tmAskaq2Lj"},{"type":"paragraph","position":{"start":{"line":239,"column":1},"end":{"line":240,"column":1}},"children":[{"type":"text","value":"Mit dem besten Modell berechnen wir dann die Feature Importance. Am wichtigsten\nsind die Signale Signal09 bis Signal12 und Signal52.","position":{"start":{"line":239,"column":1},"end":{"line":239,"column":1}},"key":"htdqZhfxci"}],"key":"AaM9UfiK3S"}],"class":"tip dropdown","key":"Uau8hB5tNi"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"ML-Modelle SVM und finales Modell","position":{"start":{"line":243,"column":1},"end":{"line":243,"column":1}},"key":"wXFD9YPtu2"}],"key":"HFi3ngklhx"},{"type":"paragraph","position":{"start":{"line":245,"column":1},"end":{"line":246,"column":1}},"children":[{"type":"text","value":"Trainieren Sie nun sowohl eine lineare SVM als auch eine nichtlineare SVM.\nOrdnen Sie ein: welches ML-Modell würden Sie final wählen?","position":{"start":{"line":245,"column":1},"end":{"line":245,"column":1}},"key":"V7CYhqOFme"}],"key":"bGEXQA0Xnb"}],"class":"tip","key":"LPMzF2jKrw"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Lösung","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"key":"xeOSnMPGDB"}],"key":"afuoxTQO6F"},{"type":"code","lang":"python","value":"from sklearn.svm import SVC\n\n# Instanziierung einer linearen SVM und Training\nsvm_linear = SVC(kernel='linear', random_state=0)\nsvm_linear.fit(X_train, y_train)\n\n# Bewertung lineare SVM\nscore_train = svm_linear.score(X_train, y_train)\nscore_test = svm_linear.score(X_test, y_test)\nprint(f'Score Trainingsdaten lineare SVM: {score_train :.2f}')\nprint(f'Score Testdaten lineare SVM: {score_test :.2f}')\n\n# Instanziierung einer nichtlinearen SVM und Training\nsvm_rbf = SVC(kernel='rbf', random_state=0)\nsvm_rbf.fit(X_train, y_train)\n\n# Bewertung nichtlineare SVM\nscore_train = svm_rbf.score(X_train, y_train)\nscore_test = svm_rbf.score(X_test, y_test)\nprint(f'Score Trainingsdaten nichtlineare SVM: {score_train :.2f}')\nprint(f'Score Testdaten nichtlineare SVM: {score_test :.2f}')","position":{"start":{"line":252,"column":1},"end":{"line":274,"column":1}},"key":"F1VxBTm8Uo"},{"type":"paragraph","position":{"start":{"line":275,"column":1},"end":{"line":275,"column":1}},"children":[{"type":"text","value":"Wir erhalten die folgenden Scores (zusammen mit den vorherigen):","position":{"start":{"line":275,"column":1},"end":{"line":275,"column":1}},"key":"SYdA2Zy4mC"}],"key":"SjBSCl8Nxy"},{"type":"table","position":{"start":{"line":278,"column":1},"end":{"line":283,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":278,"column":1},"end":{"line":278,"column":1}},"children":[{"type":"tableCell","header":true,"position":{"start":{"line":278,"column":1},"end":{"line":278,"column":1}},"children":[{"type":"text","value":"ML-Modell","position":{"start":{"line":278,"column":1},"end":{"line":278,"column":1}},"key":"lD1f5TgBRi"}],"key":"n37z7KHRhh"},{"type":"tableCell","header":true,"position":{"start":{"line":278,"column":1},"end":{"line":278,"column":1}},"children":[{"type":"text","value":"Score Training","position":{"start":{"line":278,"column":1},"end":{"line":278,"column":1}},"key":"Z7VacgwZ6g"}],"key":"BF7CT7mvfp"},{"type":"tableCell","header":true,"position":{"start":{"line":278,"column":1},"end":{"line":278,"column":1}},"children":[{"type":"text","value":"Score Test","position":{"start":{"line":278,"column":1},"end":{"line":278,"column":1}},"key":"xuBlZpXaB8"}],"key":"R8fopAvyIB"}],"key":"H0vMm42174"},{"type":"tableRow","position":{"start":{"line":280,"column":1},"end":{"line":280,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":280,"column":1},"end":{"line":280,"column":1}},"children":[{"type":"text","value":"Entscheidungsbaum","position":{"start":{"line":280,"column":1},"end":{"line":280,"column":1}},"key":"Jh68ioaHiD"}],"key":"esu2jilwQo"},{"type":"tableCell","position":{"start":{"line":280,"column":1},"end":{"line":280,"column":1}},"children":[{"type":"text","value":"1.00","position":{"start":{"line":280,"column":1},"end":{"line":280,"column":1}},"key":"OCrekjZjlJ"}],"key":"ptKFhAG64N"},{"type":"tableCell","position":{"start":{"line":280,"column":1},"end":{"line":280,"column":1}},"children":[{"type":"text","value":"0.79","position":{"start":{"line":280,"column":1},"end":{"line":280,"column":1}},"key":"QVE7JqLMk7"}],"key":"s4yXvwyLT6"}],"key":"xyHhEdxI6C"},{"type":"tableRow","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"children":[{"type":"text","value":"Random Forest","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"key":"y4aAx9dVz4"}],"key":"OjOyNlVOcI"},{"type":"tableCell","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"children":[{"type":"text","value":"1.00","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"key":"cvv7MmOzIN"}],"key":"zrrUvMBuAk"},{"type":"tableCell","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"children":[{"type":"text","value":"0.88","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"key":"Unv6Rt69Dp"}],"key":"H4UaqA6T3X"}],"key":"EYPuNbvFNF"},{"type":"tableRow","position":{"start":{"line":282,"column":1},"end":{"line":282,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":282,"column":1},"end":{"line":282,"column":1}},"children":[{"type":"text","value":"lineare SVM","position":{"start":{"line":282,"column":1},"end":{"line":282,"column":1}},"key":"vBRZD3NyP1"}],"key":"e1KXAT7dWj"},{"type":"tableCell","position":{"start":{"line":282,"column":1},"end":{"line":282,"column":1}},"children":[{"type":"text","value":"0.86","position":{"start":{"line":282,"column":1},"end":{"line":282,"column":1}},"key":"rGlXOZ6u8G"}],"key":"EOCWRXMLAl"},{"type":"tableCell","position":{"start":{"line":282,"column":1},"end":{"line":282,"column":1}},"children":[{"type":"text","value":"0.86","position":{"start":{"line":282,"column":1},"end":{"line":282,"column":1}},"key":"MWFMOAgZ8m"}],"key":"vW554UJYF0"}],"key":"KpQeREEJPI"},{"type":"tableRow","position":{"start":{"line":283,"column":1},"end":{"line":283,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":283,"column":1},"end":{"line":283,"column":1}},"children":[{"type":"text","value":"nichtlineare SVM (RBF-Kernel)","position":{"start":{"line":283,"column":1},"end":{"line":283,"column":1}},"key":"OJf2C5riep"}],"key":"Enu53oazsE"},{"type":"tableCell","position":{"start":{"line":283,"column":1},"end":{"line":283,"column":1}},"children":[{"type":"text","value":"0.88","position":{"start":{"line":283,"column":1},"end":{"line":283,"column":1}},"key":"zCDEcQbfzq"}],"key":"jARRKnPhLx"},{"type":"tableCell","position":{"start":{"line":283,"column":1},"end":{"line":283,"column":1}},"children":[{"type":"text","value":"0.79","position":{"start":{"line":283,"column":1},"end":{"line":283,"column":1}},"key":"Pt85Dm68SZ"}],"key":"KyMq8Zqu3o"}],"key":"M7FOUfCHB5"}],"key":"e0Zxfj7Hsf"},{"type":"paragraph","position":{"start":{"line":285,"column":1},"end":{"line":286,"column":1}},"children":[{"type":"text","value":"Die lineare SVM generalisiert am besten (gleicher Score auf Train/Test), während\ndie nichtlineare SVM (mit RBF-Kernel) leichtes Overfitting zeigt (0.88 vs. 0.79)","position":{"start":{"line":285,"column":1},"end":{"line":285,"column":1}},"key":"cWwL9zIk9W"}],"key":"e11WcB9RoK"},{"type":"paragraph","position":{"start":{"line":288,"column":1},"end":{"line":291,"column":1}},"children":[{"type":"text","value":"Obwohl der Random Forest das beste Ergebnis auf den Testdaten erzielt (Testscore\n0.88), entscheiden wir uns nicht für dieses Modell. Der Random Forest besteht\naus vielen Entscheidungsbäumen und ist dadurch zwar leistungsstark, aber nur\neingeschränkt interpretierbar.","position":{"start":{"line":288,"column":1},"end":{"line":288,"column":1}},"key":"CfZ1OPAOOf"}],"key":"aku7qwLOQU"},{"type":"paragraph","position":{"start":{"line":293,"column":1},"end":{"line":298,"column":1}},"children":[{"type":"text","value":"Die lineare SVM erreicht mit einem Trainings- und Testscore von jeweils 0.86\neine ähnlich gute Prognosegüte wie der Random Forest, zeigt aber keinerlei\nOverfitting. Außerdem ist sie deutlich einfacher interpretierbar, da die\nEntscheidungsregel auf einem linearen Modell basiert. Die gelernten Gewichte\ngeben direkt an, wie stark und in welche Richtung jedes Signal die\nKlassifikation beeinflusst. Das macht das lineare SVM-Modell transparent.","position":{"start":{"line":293,"column":1},"end":{"line":293,"column":1}},"key":"s3MEhYdhdH"}],"key":"oCWBD5taE3"},{"type":"paragraph","position":{"start":{"line":300,"column":1},"end":{"line":302,"column":1}},"children":[{"type":"text","value":"Daher wählen wir als finales Modell die lineare SVM, da sie stabile Ergebnisse\nliefert, gut verallgemeinert und die zugrunde liegende Entscheidungslogik\nnachvollziehbar bleibt.","position":{"start":{"line":300,"column":1},"end":{"line":300,"column":1}},"key":"Af2zpljWow"}],"key":"DdxtFq13bx"}],"class":"tip dropdown","key":"iK7ADs1pUH"}],"key":"ugZHTnJqsE"}],"key":"Q9g3lbz1lE"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"10.3 Nichtlineare SVM","url":"/chapter10-sec03","group":"10. Support Vector Machines"},"next":{"title":"11.1 Kreuzvalidierung","url":"/chapter11-sec01","group":"11. ML-Workflow Modellbewertung und Auswahl"}}},"domain":"http://localhost:3000"}